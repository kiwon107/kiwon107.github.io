I"ò$<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="13-1-k-í‰ê· -ì•Œê³ ë¦¬ì¦˜-ì†Œê°œ">13-1. K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ ì†Œê°œ</h2>
<p>k-í‰ê·  ì•Œê³ ë¦¬ì¦˜ ì‘ë™ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.<br />
 1). ë¬´ì‘ìœ„ë¡œ kê°œì˜ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì •í•œë‹¤.<br />
 2). ê° ìƒ˜í”Œì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì°¾ì•„ í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ìƒ˜í”Œë¡œ ì§€ì •í•œë‹¤.<br />
 3). í´ëŸ¬ìŠ¤í„°ì— ì†í•œ ìƒ˜í”Œì˜ í‰ê· ê°’ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ë³€ê²½í•œë‹¤.<br />
 4). í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì— ë³€í™”ê°€ ì—†ì„ ë•Œê¹Œì§€ 2ë²ˆìœ¼ë¡œ ëŒì•„ê°€ ë°˜ë³µí•œë‹¤.<br /></p>

<p>í‰ê· ê°’ì´ í´ëŸ¬ìŠ¤í„°ì˜ ì¤‘ì‹¬ì— ìœ„ì¹˜í•˜ë¯€ë¡œ <strong>í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬(Cluster center)</strong> ë˜ëŠ” <strong>ì„¼íŠ¸ë¡œì´ë“œ(Centroid)</strong> ë¼ê³  í•œë‹¤.</p>

<h2 id="13-2-kmeans-í´ë˜ìŠ¤">13-2. KMeans í´ë˜ìŠ¤</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">fruits</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'fruits_300.npy'</span><span class="p">)</span>
<span class="n">fruits_2d</span> <span class="o">=</span> <span class="n">fruits</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># n_clustersë¡œ í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ ì§€ì •
</span><span class="n">km</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fruits_2d</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">km</span><span class="p">.</span><span class="n">labels_</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) [2 2 2 2 2 0 2 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
       2 2 2 2 2 0 2 0 2 2 2 2 2 2 2 0 2 2 2 2 2 2 2 2 2 0 0 2 2 2 2 2 2 2 2 0 2
       2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
       1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
       1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
       1 1 1 1]
</code></pre></div></div>

<p>ë ˆì´ë¸” 0, 1, 2ë¡œ ëª¨ì€ ìƒ˜í”Œì˜ ê°œìˆ˜ë¥¼ í™•ì¸í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">km</span><span class="p">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) (array([0, 1, 2]), array([111,  98,  91], dtype=int64))
</code></pre></div></div>

<p>ê° í´ëŸ¬ìŠ¤í„°ê°€ ì–´ë–¤ ì´ë¯¸ì§€ë¥¼ ë‚˜íƒ€ëƒˆëŠ”ì§€ ê·¸ë¦¼ìœ¼ë¡œ ì¶œë ¥í•˜ê¸° ìœ„í•œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">draw_fruits</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">n</span> <span class="k">if</span> <span class="n">rows</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">10</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cols</span><span class="o">*</span><span class="n">ratio</span><span class="p">,</span> <span class="n">rows</span><span class="o">*</span><span class="n">ratio</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">10</span> <span class="o">+</span> <span class="n">j</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'gray_r'</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>ì´ì œ ë¶ˆë¦¬ì–¸ ì¸ë±ì‹±ì„ ì ìš©í•˜ì—¬ Trueì¸ ìœ„ì¹˜ì˜ ì›ì†Œë¥¼ ëª¨ë‘ ì¶”ì¶œí•˜ì.<br /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">draw_fruits</span><span class="p">(</span><span class="n">fruits</span><span class="p">[</span><span class="n">km</span><span class="p">.</span><span class="n">labels_</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/machinelearning/13-1.png" alt="ê·¸ë¦¼ 13-1. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 13-1. ì½”ë“œ ê²°ê³¼</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">draw_fruits</span><span class="p">(</span><span class="n">fruits</span><span class="p">[</span><span class="n">km</span><span class="p">.</span><span class="n">labels_</span><span class="o">==</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/machinelearning/13-2.png" alt="ê·¸ë¦¼ 13-2. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 13-2. ì½”ë“œ ê²°ê³¼</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">draw_fruits</span><span class="p">(</span><span class="n">fruits</span><span class="p">[</span><span class="n">km</span><span class="p">.</span><span class="n">labels_</span><span class="o">==</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/machinelearning/13-3.png" alt="ê·¸ë¦¼ 13-3. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 13-3. ì½”ë“œ ê²°ê³¼</p>
:ET