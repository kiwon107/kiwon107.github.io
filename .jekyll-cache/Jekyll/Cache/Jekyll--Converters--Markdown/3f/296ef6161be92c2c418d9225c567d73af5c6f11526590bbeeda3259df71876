I"Ç(<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="5-1-íŒ¨ì…˜-mnist-ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°">5-1. íŒ¨ì…˜ MNIST ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</h2>
<p>3ì¥ì—ì„œ ì™„ì „ ì—°ê²° ì‹ ê²½ë§ì— ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ë°€ì§‘ì¸µì— ì—°ê²°í•˜ê¸° ìœ„í•´ ì¼ë ¬ë¡œ í¼ì³¤ë‹¤. í•©ì„±ê³± ì‹ ê²½ë§ì€ 2ì°¨ì› ì´ë¯¸ì§€ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë¯€ë¡œ ì¼ë ¬ë¡œ í¼ì¹  í•„ìš”ê°€ ì—†ë‹¤. ë‹¤ë§Œ ì…ë ¥ ì´ë¯¸ì§€ëŠ” í•­ìƒ ê¹Šì´ ì°¨ì›ì´ ìˆì–´ì•¼ í•œë‹¤. <code class="language-plaintext highlighter-rouge">reshape()</code> ë©”ì†Œë“œë¡œ ì „ì²´ ë°°ì—´ ì°¨ì›ì„ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë©´ì„œ ë§ˆì§€ë§‰ì— ì°¨ì›ì„ ê°„ë‹¨íˆ ì¶”ê°€í•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">),</span> <span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">train_input</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="n">train_scaled</span><span class="p">,</span> <span class="n">val_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<p>(48000, 28, 28) í¬ê¸°ê°€ (48000, 28 ,28, 1) í¬ê¸°ê°€ ëë‹¤.</p>

<h2 id="5-2-í•©ì„±ê³±-ì‹ ê²½ë§-ë§Œë“¤ê¸°">5-2. í•©ì„±ê³± ì‹ ê²½ë§ ë§Œë“¤ê¸°</h2>
<p>í•©ì„±ê³± ì‹ ê²½ë§ êµ¬ì¡°ëŠ” í•©ì„±ê³± ì¸µìœ¼ë¡œ ì´ë¯¸ì§€ì—ì„œ íŠ¹ì§•ì„ ê°ì§€í•œ í›„ ë°€ì§‘ì¸µìœ¼ë¡œ í´ë˜ìŠ¤ì— ë”°ë¥¸ ë¶„ë¥˜ í™•ë¥ ì„ ê³„ì‚°í•œë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">'same'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<p>í•©ì„±ê³± ì¸µì—ì„œ 32ê°œ í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì„± ë§µì˜ ê¹Šì´ëŠ” 32ê°€ ëœë‹¤. (2, 2) ìµœëŒ€ í’€ë§ì„ ì ìš©í•˜ì—¬ íŠ¹ì„± ë§µì˜ í¬ê¸°ëŠ” ì ˆë°˜ìœ¼ë¡œ ì¤„ì–´ë“ ë‹¤. ë‘ ë²ˆì§¸ í•©ì„±ê³±-í’€ë§ ì¸µë„ ì¶”ê°€í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">'same'</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<p>64ê°œì˜ í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ìµœì¢…ì ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” íŠ¹ì„± ë§µì˜ í¬ê¸°ëŠ” (7, 7, 64)ê°€ ëœë‹¤.</p>

<p>ì´ì œ 3ì°¨ì› íŠ¹ì„± ë§µì„ ì¼ë ¬ë¡œ í¼ì¹˜ê³  ì™„ì „ ì—°ê²° ì‹ ê²½ë§ì„ ë§Œë“¤ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>
</code></pre></div></div>

<p>ì€ë‹‰ì¸µê³¼ ì¶œë ¥ì¸µ ì‚¬ì´ì— ë“œë¡­ì•„ì›ƒì„ ë„£ì—ˆë‹¤. ë“œë¡­ì•„ì›ƒ ì¸µì´ ì€ë‹‰ì¸µì˜ ê³¼ëŒ€ì í•©ì„ ë§‰ì•„ ì„±ëŠ¥ì„ ì¡°ê¸ˆ ë” ê°œì„ í•´ ì¤„ ê²ƒì´ë‹¤. íŒ¨ì…˜ MNIST ë°ì´í„°ì…‹ì€ í´ë˜ìŠ¤ 10ê°œë¥¼ ë¶„ë¥˜í•˜ëŠ” ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œì´ë‹¤. ë§ˆì§€ë§‰ ì¸µì˜ í™œì„±í™” í•¨ìˆ˜ëŠ” ì†Œí”„íŠ¸ë§¥ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤. ì´ì œ <code class="language-plaintext highlighter-rouge">summary()</code> ë©”ì†Œë“œë¡œ ëª¨ë¸ êµ¬ì¡°ë¥¼ ì¶œë ¥í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Model: "sequential_1"
       _________________________________________________________________
       Layer (type)                 Output Shape              Param #   
       =================================================================
       conv2d_4 (Conv2D)            (None, 28, 28, 32)        320       
       _________________________________________________________________
       max_pooling2d_1 (MaxPooling2 (None, 14, 14, 32)        0         
       _________________________________________________________________
       conv2d_5 (Conv2D)            (None, 14, 14, 64)        18496     
       _________________________________________________________________
       max_pooling2d_2 (MaxPooling2 (None, 7, 7, 64)          0         
       _________________________________________________________________
       flatten_1 (Flatten)          (None, 3136)              0         
       _________________________________________________________________
       dense_2 (Dense)              (None, 100)               313700    
       _________________________________________________________________
       dropout_1 (Dropout)          (None, 100)               0         
       _________________________________________________________________
       dense_3 (Dense)              (None, 10)                1010      
       =================================================================
       Total params: 333,526
       Trainable params: 333,526
       Non-trainable params: 0
       _________________________________________________________________
</code></pre></div></div>

<p>ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” 3x3x32+32=320 ì‹ì— ì˜í•´ ì‚°ì¶œëœë‹¤. ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” 3x3x32x64+64=18496 ì‹ì— ì˜í•´ ë‚˜ì˜¨ë‹¤. ì„¸ë²ˆì§¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” 3136x100+100=313700 ì‹ìœ¼ë¡œ ë‚˜ì˜¤ë©° ë§ˆì§€ë§‰ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” 100x10+10 ì‹ì— ì˜í•´ ë‚˜ì˜¨ë‹¤. í•„í„°ë§ˆë‹¤ í•˜ë‚˜ì˜ ì ˆí¸ì´ ìˆë‹¤ëŠ” ê²ƒì„ ê¼­ ê¸°ì–µí•˜ì!</p>
:ET