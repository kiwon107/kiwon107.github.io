I"÷M<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="7-1-ëŸ­í‚¤ë°±ì˜-í™•ë¥ ">7-1. ëŸ­í‚¤ë°±ì˜ í™•ë¥ </h2>
<p>ëŸ­í‚¤ë°±ì— ë“¤ì–´ê°„ ìƒì„ ì˜ í¬ê¸°, ë¬´ê²Œ ë“±ì´ ì£¼ì–´ì¡Œì„ ë•Œ, 7ê°œ ìƒì„ ì— ëŒ€í•œ í™•ë¥ ì„ ì¶œë ¥í•´ì•¼ í•œë‹¤ê³  í•˜ì. ê¸¸ì´, ë†’ì´, ë‘ê»˜, ëŒ€ê°ì„  ê¸¸ì´, ë¬´ê²Œë¥¼ íŠ¹ì„±ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. ì‚¬ì´í‚·ëŸ°ì˜ K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ë¡œ í´ë˜ìŠ¤ í™•ë¥ ì„ ê³„ì‚°í•  ìˆ˜ëŠ” ìˆë‹¤. í•œë²ˆ í™•ë¥ ì„ ì¶œë ¥í•´ë³´ì.</p>

<h2 id="7-2-ë°ì´í„°-ì¤€ë¹„">7-2. ë°ì´í„° ì¤€ë¹„</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">fish</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'http://bit.ly/fish_csv_data'</span><span class="p">)</span>
<span class="n">fish</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># ì²˜ìŒ 5ê°œ í–‰ ì¶œë ¥
</span></code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)  	Species	Weight	Length	Diagonal	Height	Width
        0	Bream	242.0	25.4	30.0	    11.5200	4.0200
        1	Bream	290.0	26.3	31.2	    12.4800	4.3056
        2	Bream	340.0	26.5	31.1	    12.3778	4.6961
        3	Bream	363.0	29.0	33.5	    12.7300	4.4555
        4	Bream	430.0	29.0	34.0	    12.4440	5.1340
</code></pre></div></div>

<p>íŒë‹¤ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">raed_csv()</code> í•¨ìˆ˜ëŠ” csv íŒŒì¼ì„ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•œë‹¤. ë°ì´í„°í”„ë ˆì„ì€ íŒë‹¤ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” í‘œ í˜•ì‹ì˜ ì£¼ìš” ë°ì´í„° êµ¬ì¡°ì´ë‹¤. ë„˜íŒŒì´ í–‰ë ¬ì²˜ëŸ¼ ì—´ê³¼ í–‰ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ë°ì´í„°í”„ë ˆì„ì€ í†µê³„ì™€ ê·¸ë˜í”„ë¥¼ ìœ„í•œ ë©”ì†Œë“œë¥¼ í’ë¶€í•˜ê²Œ ì œê³µí•˜ë©°, ë„˜íŒŒì´ì™€ ì‚¬ì´í‚·ëŸ°ê³¼ì˜ í˜¸í™˜ì„±ì´ ì¢‹ë‹¤.</p>

<p>ì´ì œ Species ì—´ì—ì„œ ê³ ìœ í•œ ê°’ì„ ì¶”ì¶œí•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">fish</span><span class="p">[</span><span class="s">'Species'</span><span class="p">]))</span>  <span class="c1"># unique() í•¨ìˆ˜ëŠ” ë°ì´í„°ì˜ ê³ ìœ ê°’ë“¤ì— ì–´ë–¤ ì¢…ë¥˜ê°€ ìˆëŠ”ì§€ ì•Œê³  ì‹¶ì„ ë•Œ ì‚¬ìš©!
</span></code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) ['Bream' 'Roach' 'Whitefish' 'Parkki' 'Perch' 'Pike' 'Smelt']
</code></pre></div></div>

<p>Species ì—´ì„ íƒ€ê¹ƒìœ¼ë¡œ ë§Œë“¤ê³  ë‚˜ë¨¸ì§€ 5ê°œë¥¼ ì—´ì„ ì…ë ¥ ë°ì´í„°ë¡œ ì‚¬ìš©í•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fish_input</span> <span class="o">=</span> <span class="n">fish</span><span class="p">[[</span><span class="s">'Weight'</span><span class="p">,</span> <span class="s">'Length'</span><span class="p">,</span> <span class="s">'Diagonal'</span><span class="p">,</span> <span class="s">'Height'</span><span class="p">,</span> <span class="s">'Width'</span><span class="p">]].</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">fish_target</span> <span class="o">=</span> <span class="n">fish</span><span class="p">[</span><span class="s">'Species'</span><span class="p">].</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">fish_input</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) [[242.      25.4     30.      11.52     4.02  ]
        [290.      26.3     31.2     12.48     4.3056]
        [340.      26.5     31.1     12.3778   4.6961]
        [363.      29.      33.5     12.73     4.4555]
        [430.      29.      34.      12.444    5.134 ]]
</code></pre></div></div>

<p>ê·¸ ë‹¤ìŒ, ë°ì´í„°ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆ„ê³ , ê° ì„¸íŠ¸ë¥¼ í‘œì¤€í™” ì „ì²˜ë¦¬ í•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">fish_input</span><span class="p">,</span> <span class="n">fish_target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="7-3-k-ìµœê·¼ì ‘-ì´ì›ƒ-ë¶„ë¥˜ê¸°ì˜-í™•ë¥ -ì˜ˆì¸¡">7-3. K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ì˜ í™•ë¥  ì˜ˆì¸¡</h2>
<p>ìµœê·¼ì ‘ ì´ì›ƒ ê°œìˆ˜ì¸ kë¥¼ ì§€ì •í•˜ì—¬ K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ê°€ ì˜ˆì¸¡í•œ í™•ë¥ ì„ êµ¬í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="n">kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) 0.8907563025210085
       0.85
</code></pre></div></div>

<p>ì¼ë‹¨ ê²°ê³¼ëŠ” ì´ë ‡ê²Œ ë‚˜ì™”ëŠ”ë°, ì°¸ê³ ë§Œ í•˜ê³  ì ìˆ˜ì— ëŒ€í•´ì„œëŠ” ìŠì.<br />
íƒ€ê¹ƒ ë°ì´í„° 2ê°œ ì´ìƒì˜ í´ë˜ìŠ¤ê°€ í¬í•¨ëœ ë¬¸ì œë¥¼ <strong>ë‹¤ì¤‘ ë¶„ë¥˜(Multi-class classification)</strong> ë¼ê³  í•œë‹¤. ì´ì§„ ë¶„ë¥˜ë¥¼ ì‚¬ìš©í–ˆì„ ë•ŒëŠ” ì–‘ì„± í´ë˜ìŠ¤ì™€ ìŒì„± í´ë˜ìŠ¤ë¥¼ ê°ê° 1ê³¼ 0ìœ¼ë¡œ ì§€ì •í•˜ì—¬ íƒ€ê¹ƒ ë°ì´í„°ë¥¼ ë§Œë“¤ì—ˆë‹¤. ë‹¤ì¤‘ ë¶„ë¥˜ì—ì„œë„ íƒ€ê¹ƒê°’ì„ ìˆ«ìë¡œ ë°”ê¾¸ì–´ ì…ë ¥í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‚¬ì´í‚·ëŸ°ì—ì„œëŠ” ë¬¸ìì—´ë¡œ ëœ íƒ€ê¹ƒê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤! ì´ ë•Œ, íƒ€ê¹ƒê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ì´í‚·ëŸ° ëª¨ë¸ì— ì „ë‹¬í•˜ë©´ ìˆœì„œê°€ ìë™ìœ¼ë¡œ ì•ŒíŒŒë²³ ìˆœ ì •ë ¬ëœë‹¤. ì¦‰, <code class="language-plaintext highlighter-rouge">pd.unique(fish['Species'])</code>ë¡œ ì¶œë ¥í–ˆë˜ ìˆœì„œì™€ ë‹¤ë¥´ë‹¤!</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">classes_</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) ['Bream' 'Parkki' 'Perch' 'Pike' 'Roach' 'Smelt' 'Whitefish']
</code></pre></div></div>

<p>í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ìˆëŠ” ì²˜ìŒ 5ê°œ ìƒ˜í”Œì˜ íƒ€ê¹ƒì„ ì˜ˆì¸¡í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">test_target</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) ['Perch' 'Smelt' 'Pike' 'Perch' 'Perch']
       ['Perch' 'Smelt' 'Pike' 'Whitefish' 'Perch']
</code></pre></div></div>

<p>ì‚¬ì´í‚·ëŸ°ì˜ ë¶„ë¥˜ ëª¨ë¸ì€ <code class="language-plaintext highlighter-rouge">predict_proba()</code> ë©”ì†Œë“œë¡œ í´ë˜ìŠ¤ë³„ í™•ë¥ ê°’ì„ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">proba</span> <span class="o">=</span> <span class="n">kn</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># decimals ë§¤ê°œë³€ìˆ˜ë¡œ ìœ ì§€í•  ì†Œìˆ˜ì  ì•„ë˜ ìë¦¿ìˆ˜ ì§€ì • ê°€ëŠ¥!
</span></code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) [[0.     0.     1.     0.     0.     0.     0.    ]
        [0.     0.     0.     0.     0.     1.     0.    ]
        [0.     0.     0.     1.     0.     0.     0.    ]
        [0.     0.     0.6667 0.     0.3333 0.     0.    ]
        [0.     0.     0.6667 0.     0.3333 0.     0.    ]]
</code></pre></div></div>

<p>ìœ„ 5ê°œ ë°ì´í„° ì¤‘, 4ë²ˆì§¸ ë°ì´í„°ì™€ ê°€ê¹Œìš´ ì´ì›ƒ ìƒ˜í”Œ 3ê°œì— ëŒ€í•œ íƒ€ê²Ÿì„ ë³´ë©´ ìœ„ ì½”ë“œ ê²°ê³¼ê°€ ë§ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distances</span><span class="p">,</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">kn</span><span class="p">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_target</span><span class="p">[</span><span class="n">indexes</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) [['Roach' 'Perch' 'Perch']]
</code></pre></div></div>

<p>K-ìµœê·¼ì ‘ ì´ì›ƒì€ ê²°êµ­ ì´ì›ƒ ìƒ˜í”Œ ê°œìˆ˜ë¥¼ ëª‡ê°œë¡œ ì„¤ì •í•˜ëŠëƒì— ë”°ë¼ í™•ë¥ ê°’ì´ ê³ ì •ë˜ì–´ ì¶œë ¥ëœë‹¤. ë‹¤ë¥¸ ë°©ë²•ì€ ì—†ì„ê¹Œ?</p>

<h2 id="7-4-ë¡œì§€ìŠ¤í‹±-íšŒê·€">7-4. ë¡œì§€ìŠ¤í‹± íšŒê·€</h2>
<p><strong>ë¡œì§€ìŠ¤í‹± íšŒê·€</strong>ëŠ” ì„ í˜• íšŒê·€ì™€ ë™ì¼í•˜ê²Œ ì„ í˜• ë°©ì •ì‹ì„ í•™ìŠµí•˜ëŠ” <strong>ë¶„ë¥˜ ëª¨ë¸</strong>ì´ë‹¤.<br />
$ z = a\times (Weight) + b\times (length) + c\times (Diagonal) + d\times (Height) + e\times (Width) + f $
ì—¬ê¸°ì—ì„œ $a, b, c, d, e$ëŠ” ê°€ì¤‘ì¹˜ì´ë‹¤. $z$ëŠ” ì–´ë–¤ ê°’ë„ ê°€ëŠ¥í•˜ì§€ë§Œ, í™•ë¥ ì´ ë˜ë ¤ë©´ 0~1 ì‚¬ì´ ê°’ì´ ë˜ì–´ì•¼ í•œë‹¤. $z$ê°€ ì•„ì£¼ í° ìŒìˆ˜ì´ë©´ 0, ì•„ì£¼ í° ì–‘ìˆ˜ì´ë©´ 1ì´ ë˜ë„ë¡ ë°”ê¾¸ëŠ” ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” í•¨ìˆ˜ê°€ ë°”ë¡œ <strong>ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜(Sigmoid function)</strong> ë˜ëŠ” <strong>ë¡œì§€ìŠ¤í‹± í•¨ìˆ˜(Logistic function)</strong>ì´ë‹¤.<br />
$ \phi = \frac{1}{1+e^{z}} $ <br />
zê°€ ë¬´í•œí•˜ê²Œ í° ì›€ìˆ˜ì´ë©´ ì´ í•¨ìˆ˜ëŠ” 0ì— ê°€ê¹Œì›Œì§€ê³ , zê°€ ë¬´í•œí•˜ê²Œ í° ì–‘ìˆ˜ê°€ ë˜ë©´ 1ì— ê°€ê¹Œì›Œì§„ë‹¤. zê°€ 0ì´ ë  ë•ŒëŠ” 0.5ê°€ ë˜ë©°, zê°€ ì–´ë–¤ ê°’ì´ ë˜ë”ë¼ë„ $ \phi $ëŠ”ì ˆëŒ€ 0~1 ì‚¬ì´ì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚  ìˆ˜ ì—†ë‹¤. ê·¸ë˜í”„ë¥¼ ì‹œê°í™” í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'z'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'phi'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/machinelearning/7-1.png" alt="ê·¸ë¦¼ 7-1. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 7-1. ì½”ë“œ ê²°ê³¼</p>

<p>ì´ì§„ ë¶„ë¥˜ë¥¼ í•´ë³´ì. ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ ì¶œë ¥ì´ 0.5ë³´ë‹¤ í¬ë©´ ì–‘ì„± í´ë˜ìŠ¤, 0.5ë³´ë‹¤ ì‘ìœ¼ë©´ ìŒì„± í´ë˜ìŠ¤ë¡œ íŒë‹¨í•˜ë„ë¡ ë§Œë“¤ì.</p>

<h2 id="7-5-ë¡œì§€ìŠ¤í‹±-íšŒê·€ë¡œ-ì´ì§„-ë¶„ë¥˜-ìˆ˜í–‰í•˜ê¸°">7-5. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ì´ì§„ ë¶„ë¥˜ ìˆ˜í–‰í•˜ê¸°</h2>
<p>ë„˜íŒŒì´ ë°°ì—´ì€ True, False ê°’ì„ ì „ë‹¬í•˜ì—¬ í–‰ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ <strong>ë¶ˆë¦¬ì–¸ ì¸ë±ì‹±(Boolean indexing)</strong> ë¼ê³  í•œë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">char_arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'C'</span><span class="p">,</span> <span class="s">'D'</span><span class="p">,</span> <span class="s">'E'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">char_arr</span><span class="p">[[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">]])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) ['A' 'C']
</code></pre></div></div>

<p>ì´ë¥¼ ì´ìš©í•´ì„œ, ë„ë¯¸ì™€ ë¹™ì–´ í´ë˜ìŠ¤ ë°ì´í„° ë° ë¼ë²¨ë§Œ ê³¨ë¼ë‚´ë„ë¡ í•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bream_smelt_indexes</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_target</span> <span class="o">==</span> <span class="s">'Bream'</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">train_target</span> <span class="o">==</span> <span class="s">'Smelt'</span><span class="p">)</span>
<span class="n">train_bream_smelt</span> <span class="o">=</span> <span class="n">train_scaled</span><span class="p">[</span><span class="n">bream_smelt_indexes</span><span class="p">]</span>
<span class="n">target_bream_smelt</span> <span class="o">=</span> <span class="n">train_target</span><span class="p">[</span><span class="n">bream_smelt_indexes</span><span class="p">]</span>
</code></pre></div></div>

<p>ì´ì œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ í›ˆë ¨í•˜ì—¬ í…ŒìŠ¤íŠ¸ì…‹ ì¼ë¶€ ê²°ê³¼ë¥¼ ì¶œë ¥í•´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_bream_smelt</span><span class="p">,</span> <span class="n">target_bream_smelt</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_bream_smelt</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">train_bream_smelt</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">classes_</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) ['Bream' 'Smelt' 'Bream' 'Bream' 'Bream']
       [[0.99759855 0.00240145]
        [0.02735183 0.97264817]
        [0.99486072 0.00513928]
        [0.98584202 0.01415798]
        [0.99767269 0.00232731]]
       ['Bream' 'Smelt']
</code></pre></div></div>
:ET