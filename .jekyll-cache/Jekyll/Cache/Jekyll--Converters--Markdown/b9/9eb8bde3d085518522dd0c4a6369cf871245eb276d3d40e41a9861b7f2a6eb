I"Ñ<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="7-1-ëŸ­í‚¤ë°±ì˜-í™•ë¥ ">7-1. ëŸ­í‚¤ë°±ì˜ í™•ë¥ </h2>
<p>ëŸ­í‚¤ë°±ì— ë“¤ì–´ê°„ ìƒì„ ì˜ í¬ê¸°, ë¬´ê²Œ ë“±ì´ ì£¼ì–´ì¡Œì„ ë•Œ, 7ê°œ ìƒì„ ì— ëŒ€í•œ í™•ë¥ ì„ ì¶œë ¥í•´ì•¼ í•œë‹¤ê³  í•˜ì. ê¸¸ì´, ë†’ì´, ë‘ê»˜, ëŒ€ê°ì„  ê¸¸ì´, ë¬´ê²Œë¥¼ íŠ¹ì„±ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. ì‚¬ì´í‚·ëŸ°ì˜ K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ë¡œ í´ë˜ìŠ¤ í™•ë¥ ì„ ê³„ì‚°í•  ìˆ˜ëŠ” ìˆë‹¤. í•œë²ˆ í™•ë¥ ì„ ì¶œë ¥í•´ë³´ì.</p>

<h2 id="7-2-ë°ì´í„°-ì¤€ë¹„">7-2. ë°ì´í„° ì¤€ë¹„</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">fish</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'http://bit.ly/fish_csv_data'</span><span class="p">)</span>
<span class="n">fish</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># ì²˜ìŒ 5ê°œ í–‰ ì¶œë ¥
</span></code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)  	Species	Weight	Length	Diagonal	Height	Width
        0	Bream	242.0	25.4	30.0	    11.5200	4.0200
        1	Bream	290.0	26.3	31.2	    12.4800	4.3056
        2	Bream	340.0	26.5	31.1	    12.3778	4.6961
        3	Bream	363.0	29.0	33.5	    12.7300	4.4555
        4	Bream	430.0	29.0	34.0	    12.4440	5.1340
</code></pre></div></div>

<p>íŒë‹¤ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">raed_csv()</code> í•¨ìˆ˜ëŠ” csv íŒŒì¼ì„ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•œë‹¤. ë°ì´í„°í”„ë ˆì„ì€ íŒë‹¤ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” í‘œ í˜•ì‹ì˜ ì£¼ìš” ë°ì´í„° êµ¬ì¡°ì´ë‹¤. ë„˜íŒŒì´ í–‰ë ¬ì²˜ëŸ¼ ì—´ê³¼ í–‰ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ë°ì´í„°í”„ë ˆì„ì€ í†µê³„ì™€ ê·¸ë˜í”„ë¥¼ ìœ„í•œ ë©”ì†Œë“œë¥¼ í’ë¶€í•˜ê²Œ ì œê³µí•˜ë©°, ë„˜íŒŒì´ì™€ ì‚¬ì´í‚·ëŸ°ê³¼ì˜ í˜¸í™˜ì„±ì´ ì¢‹ë‹¤.</p>

<p>ì´ì œ Species ì—´ì—ì„œ ê³ ìœ í•œ ê°’ì„ ì¶”ì¶œí•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">fish</span><span class="p">[</span><span class="s">'Species'</span><span class="p">]))</span>  <span class="c1"># unique() í•¨ìˆ˜ëŠ” ë°ì´í„°ì˜ ê³ ìœ ê°’ë“¤ì— ì–´ë–¤ ì¢…ë¥˜ê°€ ìˆëŠ”ì§€ ì•Œê³  ì‹¶ì„ ë•Œ ì‚¬ìš©!
</span></code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) ['Bream' 'Roach' 'Whitefish' 'Parkki' 'Perch' 'Pike' 'Smelt']
</code></pre></div></div>

<p>Species ì—´ì„ íƒ€ê¹ƒìœ¼ë¡œ ë§Œë“¤ê³  ë‚˜ë¨¸ì§€ 5ê°œë¥¼ ì—´ì„ ì…ë ¥ ë°ì´í„°ë¡œ ì‚¬ìš©í•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fish_input</span> <span class="o">=</span> <span class="n">fish</span><span class="p">[[</span><span class="s">'Weight'</span><span class="p">,</span> <span class="s">'Length'</span><span class="p">,</span> <span class="s">'Diagonal'</span><span class="p">,</span> <span class="s">'Height'</span><span class="p">,</span> <span class="s">'Width'</span><span class="p">]].</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">fish_target</span> <span class="o">=</span> <span class="n">fish</span><span class="p">[</span><span class="s">'Species'</span><span class="p">].</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">fish_input</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) [[242.      25.4     30.      11.52     4.02  ]
        [290.      26.3     31.2     12.48     4.3056]
        [340.      26.5     31.1     12.3778   4.6961]
        [363.      29.      33.5     12.73     4.4555]
        [430.      29.      34.      12.444    5.134 ]]
</code></pre></div></div>

<p>ê·¸ ë‹¤ìŒ, ë°ì´í„°ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆ„ê³ , ê° ì„¸íŠ¸ë¥¼ í‘œì¤€í™” ì „ì²˜ë¦¬ í•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">fish_input</span><span class="p">,</span> <span class="n">fish_target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="7-3-k-ìµœê·¼ì ‘-ì´ì›ƒ-ë¶„ë¥˜ê¸°ì˜-í™•ë¥ -ì˜ˆì¸¡">7-3. K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ì˜ í™•ë¥  ì˜ˆì¸¡</h2>
<p>ìµœê·¼ì ‘ ì´ì›ƒ ê°œìˆ˜ì¸ kë¥¼ ì§€ì •í•˜ì—¬ K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ê°€ ì˜ˆì¸¡í•œ í™•ë¥ ì„ êµ¬í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="n">kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)
</code></pre></div></div>
:ET