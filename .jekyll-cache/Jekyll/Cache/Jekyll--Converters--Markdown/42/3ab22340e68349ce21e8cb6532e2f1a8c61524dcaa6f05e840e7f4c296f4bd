I"É<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="9-1-ë¡œì§€ìŠ¤í‹±-íšŒê·€ë¡œ-ì™€ì¸-ë¶„ë¥˜í•˜ê¸°">9-1. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ì™€ì¸ ë¶„ë¥˜í•˜ê¸°</h2>
<p>ì™€ì¸ ë°ì´í„°ë¥¼ í•œë²ˆ ë´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">wine</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://bit.ly/wine_csv_data'</span><span class="p">)</span>
<span class="n">wine</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) alcohol	sugar	 pH	   class
    0	9.4 	1.9	    3.51	0.0
    1	9.8	    2.6	    3.20	0.0
    2	9.8	    2.3	    3.26	0.0
    3	9.8	    1.9	    3.16	0.0
    4	9.4	    1.9	    3.51	0.0 ë„ìˆ˜, ë‹¹ë„, PHë¥¼ ê°€ì§€ê³  ë ˆë“œì™€ì¸ì¸ì í™”ì´íŠ¸ì™€ì¸ì¸ì§€ ì•Œì•„ì•¼í•˜ëŠ” ë¬¸ì œì´ë‹¤.
</code></pre></div></div>

<p>info() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°í”„ë ˆì„ì˜ ê° ì—´ ë°ì´í„° íƒ€ì…ê³¼ ëˆ„ë½ëœ ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ”ë° ìœ ìš©í•˜ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wine</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) &lt;class 'pandas.core.frame.DataFrame'&gt;
       RangeIndex: 6497 entries, 0 to 6496
       Data columns (total 4 columns):
       alcohol    6497 non-null float64
       sugar      6497 non-null float64
       pH         6497 non-null float64
       class      6497 non-null float64
       dtypes: float64(4)
       memory usage: 203.2 KB
</code></pre></div></div>

<p>ì™€ì¸ ë°ì´í„°ë¥¼ ë³´ë©´ Non-Null Countê°€ 6497ì´ê³ , ì´ ìƒ˜í”Œ ê°œìˆ˜ë„ 6497ê°œë¼ê³  ë‚˜ì˜¨ë‹¤. ì´ì—ë”°ë¼, ëˆ„ë½ëœ ê°’ì€ ì—†ëŠ”ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. ë§Œì•½ ëˆ„ë½ëœ ê°’ì´ ìˆìœ¼ë©´, ê·¸ ë°ì´í„°ë¥¼ ë²„ë¦¬ê±°ë‚˜ í‰ê· ê°’ìœ¼ë¡œ ì±„ìš´ í›„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì–´ë–¤ ë°©ì‹ì´ ìµœì„ ì¸ì§€ëŠ” ì•Œê¸° ì–´ë ¤ìš°ë‹ˆ ë‘ ê°€ì§€ ëª¨ë‘ ì‹œë„í•´ ë³´ëŠ”ê²Œ ì¢‹ë‹¤! ë§Œì•½ í‰ê· ê°’ìœ¼ë¡œ ì±„ì›Œ ë„£ëŠ”ë‹¤ê³  í•˜ë©´, í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ëˆ„ë½ëœ ê°’ì€ í›ˆë ¨ ì„¸íŠ¸ì˜ í‰ê· ê°’ìœ¼ë¡œ ì±„ì›Œì•¼ í•œë‹¤!</p>

<p>describe() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì—´ë° ëŒ€í•œ ê°„ëµí•œ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wine</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)      alcohol	    sugar	        pH	      class
    count	6497.000000	6497.000000	6497.000000	6497.000000
    mean	10.491801	5.443235	3.218501	0.753886
    std	    1.192712	4.757804	0.160787	0.430779
    min	    8.000000	0.600000	2.720000	0.000000
    25%	    9.500000	1.800000	3.110000	1.000000
    50%	    10.300000	3.000000	3.210000	1.000000
    75%	    11.300000	8.100000	3.320000	1.000000
    max	    14.900000	65.800000	4.010000	1.000000
</code></pre></div></div>

<p>í‰ê· , í‘œì¤€í¸ì°¨, ìµœì†Œ, ìµœëŒ€ê°’ì„ ë³¼ ìˆ˜ ìˆë‹¤. ì¤‘ê°„ê°’(50%), 1ì‚¬ë¶„ìœ„ìˆ˜(25%), 3ì‚¬ë¶„ìœ„ìˆ˜(75%)ë„ ì•Œë ¤ì¤€ë‹¤.
ì‚¬ë¶„ìœ„ìˆ˜ëŠ” ë°ì´í„°ë¥¼ ì¼ë ¬ë¡œ ëŠ˜ì–´ë†“ê³ , ë°ì´í„°ë¥¼ ìˆœì„œëŒ€ë¡œ 4ë“±ë¶„ í•œ ê°’ì´ë‹¤. ë§Œì•½ ë°ì´í„° ê°œìˆ˜ê°€ ì§ìˆ˜ê°œ ì´ë©´ ì¤‘ì•™ê°’ì€ ê°€ìš´ëŒ€ 2ê°œì˜ ê°’ì˜ í‰ê· ì„ ì‚¬ìš©í•œë‹¤ê³  í•œë‹¤.
ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ì™€ì¸ì„ ë¶„ë¥˜í•´ë³´ì!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">wine</span><span class="p">[[</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="s">'sugar'</span><span class="p">,</span> <span class="s">'pH'</span><span class="p">]].</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">wine</span><span class="p">[</span><span class="s">'class'</span><span class="p">].</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_input</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test_input</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) (5197, 3) (1300, 3)
       0.7808350971714451
       0.7776923076923077
</code></pre></div></div>

:ET