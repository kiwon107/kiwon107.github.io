I"x<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="9-1-lstm-êµ¬ì¡°">9-1. LSTM êµ¬ì¡°</h2>
<p><strong>LSTM(Long Shor-Term Memory)</strong>ëŠ” ë‹¨ê¸° ê¸°ì–µì„ ì˜¤ë˜ ê¸°ì–µí•˜ê¸° ìœ„í•´ ê³ ì•ˆë˜ì—ˆë‹¤. LSTMì—ëŠ” ì…ë ¥ê³¼ ê°€ì¤‘ì¹˜ë¥¼ ê³±í•˜ê³  ì ˆí¸ì„ ë”í•´ í™œì„±í™” í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œí‚¤ëŠ” êµ¬ì¡°ë¥¼ ì—¬ëŸ¬ê°œ ê°€ì§€ê³  ìˆë‹¤. ì´ëŸ° ê³„ì‚° ê²°ê³¼ëŠ” ë‹¤ìŒ íƒ€ì„ìŠ¤í…ì— ì¬ì‚¬ìš© ëœë‹¤.</p>

<p class="align-center">ì€ë‹‰ìƒíƒœë¥¼ ë¨¼ì € ë³´ì. ì€ë‹‰ ìƒíƒœëŠ” ì…ë ¥ê³¼ ì´ì „ íƒ€ì„ìŠ¤í…ì˜ ì€ë‹‰ ìƒíƒœë¥¼ ê°€ì¤‘ì¹˜ì— ê³±í•œ í›„ í™œì„±í™” í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œì¼œ ë‹¤ìŒ ì€ë‹‰ ìƒíƒœë¥¼ ë§Œë“ ë‹¤. ì´ ë•Œ í™œì„±í™” í•¨ìˆ˜ë¥´ ì‹œê·¸ëª¨ì´ë“œ í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ë˜ tanh í™œì„±í™” í•¨ìˆ˜ë¥¼ í†µê³¼í•œ ì–´ë–¤ ê°’ê³¼ ê³±í•´ì ¸ì„œ ì€ë‹‰ ìƒíƒœë¥¼ ë§Œë“ ë‹¤. ì•ìœ¼ë¡œ ë‚˜ì˜¬ ê¸°í˜¸ ì¤‘, í¸ì˜ìƒ ì€ë‹‰ ìƒíƒœ ê³„ì‚°ì‹œ ê°€ì¤‘ì¹˜ $w_{x}}$ ì™€ $w_{h}$ ë¥¼ í†µí‹€ì–´ $w_{o}$ ë¼ê³  í•˜ì.
<img src="/assets/images/deeplearningtens/9-1.png" alt="ê·¸ë¦¼ 9-1. LSTM êµ¬ì¡°" /></p>
<p>ê·¸ë¦¼ 9-1. LSTM êµ¬ì¡°</p>

<p>LSTMì—ëŠ” ìˆœí™˜ë˜ëŠ” ìƒíƒœê°€ 2ê°œë‹¤. ì€ë‹‰ ìƒíƒœ ë§ê³  <strong>ì…€ ìƒíƒœ(Cell state)</strong>ë¼ê³  ë¶€ë¥´ëŠ” ê°’ì´ ë”°ë¡œ ìˆë‹¤. ì…€ ìƒíƒœëŠ” ë‹¤ìŒ ì¸µìœ¼ë¡œ ì „ë‹¬ë˜ì§€ ì•Šê³  LSTM ì…€ì—ë§Œ ìˆœí™˜ë˜ëŠ” ê°’ì´ë‹¤. ì€ë‹‰ ìƒíƒœ hì™€ êµ¬ë¶„ì§€ì–´ cë¡œ í‘œì‹œí•˜ì. ì…€ ìƒíƒœë¥¼ ê³„ì‚°í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<p>ë¨¼ì € ì…ë ¥ê³¼ ì€ë‹‰ ìƒíƒœë¥¼ ë˜ ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ $w_{f}$ ì— ê³±í•œ ë‹¤ìŒ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œí‚¨ë‹¤. ê·¸ ë‹¤ìŒ ì´ì „ íƒ€ì„ìŠ¤í…ì˜ ì…€ ìƒíƒœì™€ ê³±í•˜ì—¬ ìƒˆë¡œìš´ ì…€ ìƒíƒœë¥¼ ë§Œë“ ë‹¤. ì´ ì…€ ìƒíƒœê°€ ì˜¤ë¥¸ìª½ tanh í•¨ìˆ˜ë¥¼ í†µê³¼í•˜ì—¬ ìƒˆë¡œìš´ ì€ë‹‰ ìƒíƒœë¥¼ ë§Œë“œëŠ”ë° ê¸°ì—¬í•œë‹¤. ì¤‘ìš”í•œ ê²ƒì€ ì…ë ¥ê³¼ ì€ë‹‰ ìƒíƒœì— ê³±í•´ì§€ëŠ” ê°€ì¤‘ì¹˜ $w_{o}$ì™€ $w_{f}$ ê°€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ ë‘ ì‘ì€ ì…€ì€ ê°ê¸° ë‹¤ë¥¸ ê¸°ëŠ¥ì„ ìœ„í•´ í›ˆë ¨ëœë‹¤.</p>

<p>ì—¬ê¸°ì— 2ê°œì˜ ì‘ì€ ì…€ì´ ì¶”ê°€ë˜ì–´ ì…€ ìƒíƒœë¥¼ ë§Œë“œëŠ”ë° ê¸°ì—¬í•œë‹¤. ì´ì „ì²˜ëŸ¼ ì…ë ¥ê³¼ ì€ë‹‰ ìƒíƒœë¥¼ ê°ê¸° ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ì— ê³±í•œ ë‹¤ìŒ, í•˜ë‚˜ëŠ” ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œí‚¤ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” tanh í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œí‚¨ë‹¤. ê·¸ ë‹¤ìŒ ë‘ ê²°ê³¼ë¥¼ ê³±í•œ í›„ ì´ì „ ì…€ ìƒíƒœì™€ ë”í•œë‹¤. ì´ ê²°ê³¼ê°€ ìµœì¢…ì ì¸ ë‹¤ìŒ ì…€ ìƒíƒœê°€ ëœë‹¤.</p>

<p>ê·¸ë¦¼ 9-1 ì²˜ëŸ¼ ì„¸ êµ°ë°ì˜ ê³±ì…ˆì„ ì™¼ìª½ë¶€í„° ì°¨ë¡€ëŒ€ë¡œ ì‚­ì œ ê²Œì´íŠ¸, ì…ë ¥ ê²Œì´íŠ¸, ì¶œë ¥ ê²Œì´íŠ¸ ë¼ê³  ë¶€ë¥¸ë‹¤. ì‚­ì œ ê²Œì´íŠ¸ëŠ” ì…€ ìƒíƒœì— ìˆëŠ” ì •ë³´ë¥¼ ì œê±°í•˜ëŠ” ì—­í• ì„ í•˜ê³ , ì…ë ¥ ê²Œì´íŠ¸ëŠ” ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì…€ ìƒíƒœì— ì¶”ê°€í•œë‹¤. ì¶œë ¥ ê²Œì´íŠ¸ë¥¼ í†µí•´ ì´ ì…€ ìƒíƒœê°€ ë‹¤ìŒ ì€ë‹‰ ìƒíƒœë¡œ ì¶œë ¥ëœë‹¤.</p>

<h2 id="9-2-lstm-ì‹ ê²½ë§-í›ˆë ¨í•˜ê¸°">9-2. LSTM ì‹ ê²½ë§ í›ˆë ¨í•˜ê¸°</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">imdb</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">),</span> <span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)</span> <span class="o">=</span> <span class="n">imdb</span><span class="p">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">train_input</span><span class="p">,</span> <span class="n">val_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.sequence</span> <span class="kn">import</span> <span class="n">pad_sequences</span>
<span class="n">train_seq</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">val_seq</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Model: "sequential"
       _________________________________________________________________
       Layer (type)                 Output Shape              Param #   
       =================================================================
       embedding (Embedding)        (None, 100, 16)           8000      
       _________________________________________________________________
       lstm (LSTM)                  (None, 8)                 800       
       _________________________________________________________________
       dense (Dense)                (None, 1)                 9         
       =================================================================
       Total params: 8,809
       Trainable params: 8,809
       Non-trainable params: 0
       _________________________________________________________________
</code></pre></div></div>

<p>SimpleRNN í´ë˜ìŠ¤ì˜ ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” 200ê°œì˜€ë‹¤. LSTM ì…€ì—ëŠ” ì‘ì€ ì…€ì´ 4ê°œê°€ ìˆìœ¼ë¯€ë¡œ ì •í™•íˆ 4ë°°ê°€ ëŠ˜ì–´ ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” 800ê°œê°€ ë˜ì—ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rmsprop</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">rmsprop</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">checkpoint_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s">'best-lstm-model.h5'</span><span class="p">)</span>
<span class="n">early_stopping_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_seq</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">val_seq</span><span class="p">,</span> <span class="n">val_target</span><span class="p">),</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint_cb</span><span class="p">,</span> <span class="n">early_stopping_cb</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Epoch 1/100
       313/313 [==============================] - 16s 52ms/step - loss: 0.6926 - accuracy: 0.5432 - val_loss: 0.6919 - val_accuracy: 0.5836
       Epoch 2/100
       ...
       Epoch 42/100
       313/313 [==============================] - 15s 49ms/step - loss: 0.3978 - accuracy: 0.8206 - val_loss: 0.4283 - val_accuracy: 0.8026
       Epoch 43/100
       313/313 [==============================] - 16s 51ms/step - loss: 0.3973 - accuracy: 0.8217 - val_loss: 0.4273 - val_accuracy: 0.8074
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'epoch'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'train'</span><span class="p">,</span> <span class="s">'val'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/deeplearningtens/9-2.png" alt="ê·¸ë¦¼ 9-2. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 9-2. ì½”ë“œ ê²°ê³¼</p>

<h2 id="9-3-ìˆœí™˜ì¸µì—-ë“œë¡­ì•„ì›ƒ-ì ìš©í•˜ê¸°">9-3. ìˆœí™˜ì¸µì— ë“œë¡­ì•„ì›ƒ ì ìš©í•˜ê¸°</h2>
<p>ì™„ì „ ì—°ê²° ì‹ ê²½ë§ê³¼ í•©ì„±ê³± ì‹ ê²½ë§ì—ì„œëŠ” Dropout í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë“œë¡­ì•„ì›ƒì„ ì ìš©í–ˆë‹¤. ìˆœí™˜ì¸µì€ ìì²´ì ìœ¼ë¡œ ë“œë¡­ì•„ì›ƒ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. SimpleRNNê³¼ LSTM í´ë˜ìŠ¤ ëª¨ë‘ <code class="language-plaintext highlighter-rouge">dropout</code> ë§¤ê°œë³€ìˆ˜ì™€ <code class="language-plaintext highlighter-rouge">recurrent_dropout</code> ë§¤ê°œë³€ìˆ˜ë¥¼ ê°–ëŠ”ë‹¤. <code class="language-plaintext highlighter-rouge">dropout</code> ë§¤ê°œë³€ìˆ˜ëŠ” ì…€ì˜ ì…ë ¥ì— ë“œë¡­ì•„ì›ƒì„ ì ìš©í•œë‹¤. <code class="language-plaintext highlighter-rouge">recurrent_dropout</code>ì€ ìˆœí™˜ë˜ëŠ” ì€ë‹‰ ìƒíƒœì— ë“œë¡­ì•„ì›ƒì„ ì ìš©í•œë‹¤. ê¸°ìˆ ì ì¸ ë¬¸ì œë¡œ ì¸í•´ <code class="language-plaintext highlighter-rouge">recurrent_dropout</code>ì„ ì‚¬ìš©í•˜ë©´ GPUë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ì§€ ëª»í•œë‹¤. ì´ ë•Œë¬¸ì— ëª¨ë¸ì˜ í›ˆë ¨ ì†ë„ê°€ í¬ê²Œ ëŠë ¤ì§„ë‹¤. ì—¬ê¸°ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">dropout</code>ë§Œ ì‚¬ìš©í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model2</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">model2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.3</span><span class="p">))</span>
<span class="n">model2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layerse</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">))</span>

<span class="n">rmsprop</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">model2</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">rmsprop</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">checkpoint_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s">'best-dropout-model.h5'</span><span class="p">)</span>
<span class="n">early_stopping_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model2</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_seq</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">val_seq</span><span class="p">,</span> <span class="n">val_target</span><span class="p">),</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint_cb</span><span class="p">,</span> <span class="n">early_stopping_cb</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Epoch 1/100
       313/313 [==============================] - 18s 57ms/step - loss: 0.6928 - accuracy: 0.5210 - val_loss: 0.6922 - val_accuracy: 0.5452
       Epoch 2/100
       313/313 [==============================] - 16s 50ms/step - loss: 0.6910 - accuracy: 0.5778 - val_loss: 0.6899 - val_accuracy: 0.6154
       ...
       Epoch 44/100
       313/313 [==============================] - 29s 94ms/step - loss: 0.4110 - accuracy: 0.8140 - val_loss: 0.4284 - val_accuracy: 0.8038
       Epoch 45/100
       313/313 [==============================] - 25s 81ms/step - loss: 0.4107 - accuracy: 0.8110 - val_loss: 0.4288 - val_accuracy: 0.8004
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'epoch'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'train'</span><span class="p">,</span> <span class="s">'val'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/deeplearningtens/9-3.png" alt="ê·¸ë¦¼ 9-3. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 9-3. ì½”ë“œ ê²°ê³¼</p>

<p>ë“œë¡­ì•„ì›ƒì˜ íš¨ê³¼ê°€ ë°œíœ˜ëœ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. í›ˆë ¨ ì†ì‹¤ê³¼ ê²€ì¦ ì†ì‹¤ ê°„ ì°¨ì´ê°€ ì¢í˜€ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<h2 id="9-4-2ê°œì˜-ì¸µì„-ì—°ê²°í•˜ê¸°">9-4. 2ê°œì˜ ì¸µì„ ì—°ê²°í•˜ê¸°</h2>
<p>ìˆœí™˜ì¸µ ì—°ê²°ì‹œ ì£¼ì˜í•  ì ì´ ìˆë‹¤. ìˆœí™˜ì¸µì˜ ì€ë‹‰ ìƒíƒœëŠ” ìƒ˜í”Œì˜ ë§ˆì§€ë§‰ íƒ€ì„ìŠ¤í…ì— ëŒ€í•œ ì€ë‹‰ ìƒíƒœë§Œ ë‹¤ìŒ ì¸µìœ¼ë¡œ ì „ë‹¬ëœë‹¤. í•˜ì§€ë§Œ ìˆœí™˜ì¸µì„ ìŒ“ê²Œ ë˜ë©´ ëª¨ë“  ìˆœí™˜ì¸µì— ìˆœì°¨ ë°ì´í„°ê°€ í•„ìš”í•˜ë‹¤. ë”°ë¼ì„œ ì•ìª½ì˜ ìˆœí™˜ì¸µì´ ëª¨ë“  íƒ€ì„ìŠ¤í…ì— ëŒ€í•œ ì€ë‹‰ ìƒíƒœë¥¼ ì¶œë ¥í•´ì•¼ í•œë‹¤. ì˜¤ì§ ë§ˆì§€ë§‰ ìˆœí™˜ì¸µë§Œ ë§ˆì§€ë§‰ íƒ€ì„ìŠ¤í…ì˜ ì€ë‹‰ ìƒíƒœë¥¼ ì¶œë ¥í•´ì•¼ í•œë‹¤. ì¼€ë¼ìŠ¤ì˜ ìˆœí™˜ì¸µì—ì„œ ëª¨ë“  íƒ€ì„ìŠ¤í…ì˜ ì€ë‹‰ ìƒíƒœë¥¼ ì¶œë ¥í•˜ë ¤ë©´ ë§ˆì§€ë§‰ì„ ì œì™¸í•œ ë‹¤ë¥¸ ëª¨ë“  ìˆœí™˜ì¸µì—ì„œ <code class="language-plaintext highlighter-rouge">return_sequences</code> ë§¤ê°œë³€ìˆ˜ë¥¼ Trueë¡œ ì§€ì •í•˜ë©´ ëœë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model3</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model3</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">model3</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="n">model3</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.3</span><span class="p">))</span>
<span class="n">model3</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">))</span>

<span class="n">model3</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Model: "sequential_4"
       _________________________________________________________________
       Layer (type)                 Output Shape              Param #   
       =================================================================
       embedding_4 (Embedding)      (None, 100, 16)           8000      
       _________________________________________________________________
       lstm_3 (LSTM)                (None, 100, 8)            800       
       _________________________________________________________________
       lstm_4 (LSTM)                (None, 8)                 544       
       _________________________________________________________________
       dense_2 (Dense)              (None, 1)                 9         
       =================================================================
       Total params: 9,353
       Trainable params: 9,353
       Non-trainable params: 0
       _________________________________________________________________
</code></pre></div></div>

<p>ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” ê°ê° 500 x 16 = 8000, (16 x 8 + 8 x 8 + 8) x 4 = 800, (8 x 8 + 8 x 8 + 8) x 4 = 544, 8 x 1 + 1 = 9 ë¡œ ì‚°ì¶œëœë‹¤. ì²« ë²ˆì§¸ LSTM ì¸µì„ ë³´ë©´ ëª¨ë“  íƒ€ì„ìŠ¤í… 100ê°œì˜ ì€ë‹‰ ìƒíƒœë¥¼ ì¶œë ¥í•˜ë¯€ë¡œ ì¶œë ¥ í¬ê¸°ê°€ (None, 100, 8)ë¡œ í‘œì‹œë˜ì—ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‘ ë²ˆì§¸ LSTMì¸µì€ ë§ˆì§€ë§‰ íƒ€ì„ìŠ¤í…ì˜ ì€ë‹‰ ìƒíƒœë§Œ ì¶œë ¥í•˜ë¯€ë¡œ (None, 8) ì´ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rmsprop</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">model3</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">rmsprop</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">checkpoint_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s">'best-2rnn-model.h5'</span><span class="p">)</span>
<span class="n">earlystopping_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model3</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_seq</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">val_seq</span><span class="p">,</span> <span class="n">val_target</span><span class="p">),</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint_cb</span><span class="p">,</span> <span class="n">earlystopping_cb</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'epoch'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'train'</span><span class="p">,</span> <span class="s">'val'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/deeplearningtens/9-4.png" alt="ê·¸ë¦¼ 9-4. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 9-4. ì½”ë“œ ê²°ê³¼</p>

<p>ê³¼ëŒ€ì í•©ì„ ì œì–´í•˜ë©´ì„œ ì†ì‹¤ì„ ìµœëŒ€í•œ ë‚®ì·„ë‹¤.</p>

<h2 id="9-5-gru-êµ¬ì¡°">9-5. GRU êµ¬ì¡°</h2>
<p class="align-center"><strong>GRU(Gated Recurrent Unit)</strong>ì€ LSTMì„ ê°„ì†Œí™”í•œ ë²„ì „ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤. ì´ ì…€ì€ LSTM ì²˜ëŸ¼ ì…€ ìƒíƒœë¥¼ ê³„ì‚°í•˜ì§€ ì•Šê³  ì€ë‹‰ ìƒíƒœ í•˜ë‚˜ë§Œ í¬í•¨í•œë‹¤.
<img src="/assets/images/deeplearningtens/9-5.png" alt="ê·¸ë¦¼ 9-5. GRU êµ¬ì¡°" /></p>
<p>ê·¸ë¦¼ 9-5. GRU êµ¬ì¡°</p>

<p>GRU ì…€ì—ëŠ” ì€ë‹‰ ìƒíƒœì™€ ì…ë ¥ì— ê°€ì¤‘ì¹˜ë¥¼ ê³±í•˜ê³  ì ˆí¸ì„ ë”í•˜ëŠ” ì‘ì€ ì…€ì´ 3ê°œ ë“¤ì–´ ìˆë‹¤. 2ê°œëŠ” ì‹œê·¸ëª¨ì´ë“œ í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³ , í•˜ë‚˜ëŠ” tanh í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ì—¬ê¸°ì—ì„œë„ ì€ë‹‰ ìƒíƒœì™€ ì…ë ¥ì— ê³±í•´ì§€ëŠ” ê°€ì¤‘ì¹˜ë¥¼ í•©ì³ì„œ ë‚˜íƒ€ëƒˆë‹¤. ë§¨ ì™¼ìª½ $w_{z}$ ë¥¼ ì‚¬ìš©í•˜ëŠ” ì…€ì˜ ì¶œë ¥ì´ ì€ë‹‰ ìƒíƒœì— ë°”ë¡œ ê³±í•´ì ¸ ì‚­ì œ ê²Œì´íŠ¸ ì—­í• ì„ ìˆ˜í–‰í•œë‹¤. ì´ì™€ ë˜‘ê°™ì€ ì¶œë ¥ì„ 1ì—ì„œ ëº€ ë‹¤ìŒ ê°€ì¥ ì˜¤ë¥¸ìª½ $w_{g}$ë¥¼ ì‚¬ìš©í•˜ëŠ” ì…€ì˜ ì¶œë ¥ì— ê³±í•œë‹¤. ì´ëŠ” ì…ë ¥ë˜ëŠ” ì •ë³´ë¥¼ ì œì–´í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤. $w_{r}$ì„ ì‚¬ìš©í•˜ëŠ” ì…€ì—ì„œ ì¶œë ¥ëœ ê°’ì€ $w_{g}$ ì…€ì´ ì‚¬ìš©í•  ì€ë‹‰ ìƒíƒœì˜ ì •ë³´ë¥¼ ì œì–´í•œë‹¤. GRU ì…€ì€ LSTM ë³´ë‹¤ ê°€ì¤‘ì¹˜ê°€ ì ê¸° ë•Œë¬¸ì— ê³„ì‚°ëŸ‰ì´ ì ì§€ë§Œ LSTM ëª»ì§€ì•ŠëŠ” ì¢‹ì€ ì„±ëŠ¥ì„ ë‚´ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì¡Œë‹¤.</p>

<h2 id="9-6-gru-ì‹ ê²½ë§-í›ˆë ¨í•˜ê¸°">9-6. GRU ì‹ ê²½ë§ í›ˆë ¨í•˜ê¸°</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model4</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model4</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">model4</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">GRU</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="n">model4</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">))</span>

<span class="n">model4</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)
</code></pre></div></div>

<p>GRU ì¸µì˜ ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ë¥¼ ê³„ì‚°í•´ë³´ì. GRU ì…€ì—ëŠ” 3ê°œì˜ ì‘ì€ ì…€ì´ ìˆìœ¼ë¯€ë¡œ (16 x 8 + 8 x 8 + 8) x 3 = 600ê°œê°€ ìˆë‹¤. ì—¬ê¸°ì— í•œê°€ì§€ê°€ ë” ìˆë‹¤. ì‚¬ì‹¤ $w_{g}$ ë¡œ í‘œí˜„ëœê²Œ $w_{x}$ ì™€ $w_{h}$ ë¡œ ë‚˜ëˆ ì§„ë‹¤. í…ì„œí”Œë¡œê°€ ì´ëŸ° ê³„ì‚° ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” GPUë¥¼ ì˜ í™œìš©í•˜ê¸° ìœ„í•´ì„œì´ë‹¤. ë„ë¦¬ í†µìš©ë˜ëŠ” ì´ë¡ ê³¼ êµ¬í˜„ì´ ì¢…ì¢… ì°¨ì´ê°€ ë‚  ìˆ˜ ìˆìœ¼ë‹ˆ GRU ì¸µì˜ ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ë¥¼ í˜¼ë™í•˜ì§€ ë§ì!</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rmsprop</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">optimizers</span><span class="p">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">model4</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">rmsprop</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="n">checkpoint_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s">'best-gru-model.h5'</span><span class="p">)</span>
<span class="n">earlystopping_cb</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model4</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_seq</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">val_seq</span><span class="p">,</span> <span class="n">val_target</span><span class="p">),</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpooint_cb</span><span class="p">,</span> <span class="n">early_stopping_cb</span><span class="p">])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'epoch'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'train'</span><span class="p">,</span> <span class="s">'val'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>ë“œë¡­ì•„ì›ƒì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ ì´ì „ë³´ë‹¤ í›ˆë ¨ ì†ì‹¤ê³¼ ê²€ì¦ ì†ì‹¤ ì‚¬ì´ì— ì°¨ì´ê°€ ìˆì§€ë§Œ í›ˆë ¨ ê³¼ì •ì´ ì˜ ìˆ˜ë ´ë˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
:ET