I"ìW<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="2-1-2ê°œì˜-ì¸µ">2-1. 2ê°œì˜ ì¸µ</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">),</span> <span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">train_input</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">train_scaled</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">train_scaled</span><span class="p">,</span> <span class="n">val_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<p>1ì¥ê³¼ ì•½ê°„ ë‹¤ë¥´ê²Œ ì…ë ¥ì¸µê³¼ ì¶œë ¥ì¸µ ì‚¬ì´ì— ë°€ì§‘ì¸µì„ ì¶”ê°€í•´ë³¼ ê²ƒì´ë‹¤. ì…ë ¥ì¸µê³¼ ì¶œë ¥ì¸µ ì‚¬ì´ì— ìˆëŠ” ëª¨ë“  ì¸µì„ <strong>ì€ë‹‰ì¶©(Hidden layer)</strong> ë¼ê³  í•œë‹¤. ì€ë‹‰ì¸µì—ë„ í™œì„±í™” í•¨ìˆ˜ê°€ ì¡´ì¬í•œë‹¤. í™œì„±í™” í•¨ìˆ˜ëŠ” ì‹ ê²½ë§ ì¸µì˜ ì„ í˜• ë°©ì •ì‹ì˜ ê³„ì‚° ê°’ì— ì ìš©í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. ì¶œë ¥ì¸µì—ì„œëŠ” ì´ì§„ ë¶„ë¥˜ì¼ ê²½ìš° ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜, ë‹¤ì¤‘ ë¶„ë¥˜ì¼ ê²½ìš° ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¡œ í™œì„±í™” í•¨ìˆ˜ê°€ ì œí•œë˜ì—ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì€ë‹‰ì¸µì˜ í™œì„±í™” í•¨ìˆ˜ëŠ” ë¹„êµì  ììœ ë¡­ë‹¤. ì°¸ê³ ë¡œ íšŒê·€ì˜ ì¶œë ¥ì€ ì„ì˜ì˜ ì–´ë–¤ ìˆ«ìì´ë¯€ë¡œ í™œì„±í™” í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.<br />
ìš°ë¦¬ëŠ” ì™œ ì€ì¹™ì¸µì— í™œì„±í™” í•¨ìˆ˜ë¥¼ ì ìš©í•´ì•¼ í• ê¹Œ? ë§Œì•½ í™œì„±í™” í•¨ìˆ˜ ì—†ì´ ì„ í˜•ì ì¸ ì‚°ìˆ  ê³„ì‚°ë§Œ ì€ë‹‰ì¸µì—ì„œ ìˆ˜í–‰í•œë‹¤ë©´, ì‚¬ì‹¤ ì€ë‹‰ì¸µì´ ìˆ˜í–‰í•˜ëŠ” ì—­í• ì€ ì—†ëŠ”ê±°ë‚˜ ë§ˆì°¬ê°€ì§€ë‹¤. ì„ í˜• ê³„ì‚°ì„ ì ë‹¹í•˜ê²Œ ë¹„ì„ í˜•ìœ¼ë¡œ ë¹„í‹€ì–´ ì£¼ì–´ì•¼ ë‚˜ë¦„ì˜ ì€ë‹‰ì¸µ ì—­í• ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dense1</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="p">))</span>
<span class="n">dense2</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì€ë‹‰ì¸µì˜ ë‰´ëŸ° ê°œìˆ˜ë¥¼ ì •í•˜ëŠ”ë° íŠ¹ë³„í•œ ê¸°ì¤€ì€ ì—†ë‹¤. ëª‡ ê°œì˜ ë‰´ëŸ°ì„ ë‘ì–´ì•¼ í• ì§€ íŒë‹¨í•˜ë ¤ë©´ ìƒë‹¹í•œ ê²½í—˜ì´ í•„ìš”í•˜ë‹¤. ê·¸ë ‡ì§€ë§Œ í•œê°€ì§€ ì œì•½ì‚¬í•­ì€ ìˆë‹¤. ì ì–´ë„ ì¶œë ¥ì¸µì˜ ë‰´ëŸ°ë³´ë‹¤ëŠ” ë§ê²Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í´ë˜ìŠ¤ 10ê°œì— ëŒ€í•œ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ëŠ”ë°, ì´ì „ ì€ë‹‰ì¸µì˜ ë‰´ëŸ°ì´ 10ê°œë³´ë‹¤ ì ë‹¤ë©´ ë¶€ì¡±í•œ ì •ë³´ê°€ ì „ë‹¬ë  ê²ƒì´ë‹¤.</p>

<h2 id="1-2-ì‹¬ì¸µ-ì‹ ê²½ë§-ë§Œë“¤ê¸°">1-2. ì‹¬ì¸µ ì‹ ê²½ë§ ë§Œë“¤ê¸°</h2>
<p>ì´ì œ ì•ì—ì„œ ë§Œë“  dense1ê³¼ dense2 ê°ì²´ë¥¼ <code class="language-plaintext highlighter-rouge">Sequential</code> í´ë˜ìŠ¤ì— ì¶”ê°€í•˜ì—¬ <strong>ì‹¬ì¸µ ì‹ ê²½ë§(Deep neural network)</strong>ì„ ë§Œë“¤ì–´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">dense1</span><span class="p">,</span> <span class="n">dense2</span><span class="p">])</span>
</code></pre></div></div>

<p>ì¶œë ¥ì¸µì€ ê¼­ ê°€ì¥ ë§ˆì§€ë§‰ì— ë‘ì–´ì•¼ í•œë‹¤!<br />
ì¼€ë¼ìŠ¤ ëª¨ë¸ì˜ <code class="language-plaintext highlighter-rouge">summary()</code> ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì¸µì— ëŒ€í•œ ìœ ìš©í•œ ì •ë³´ë¥¼ ì–»ì–´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Model: "sequential"
       _________________________________________________________________
       Layer (type)                 Output Shape              Param #   
       =================================================================
       dense_2 (Dense)              (None, 100)               78500     
       _________________________________________________________________
       dense_3 (Dense)              (None, 10)                1010      
       =================================================================
       Total params: 79,510
       Trainable params: 79,510
       Non-trainable params: 0
       _________________________________________________________________
</code></pre></div></div>

<p>ì¶œë ¥ì„ ë³´ë©´ ì²« ì¤„ì—ëŠ” ëª¨ë¸ ì´ë¦„ì´ ë‚˜ì˜¨ë‹¤. ê·¸ ë‹¤ìŒ ëª¨ë¸ì— ë“¤ì–´ ìˆëŠ” ì¸µì´ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´ëœë‹¤. ì¸µë§ˆë‹¤ ì¸µ ì´ë¦„, í´ë˜ìŠ¤, ì¶œë ¥ í¬ê¸°, ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ê°€ ë‚˜ì˜¨ë‹¤. ì¸µì„ ë§Œë“¤ ë•Œ <code class="language-plaintext highlighter-rouge">name</code> ë§¤ê°œë³€ìˆ˜ë¡œ ì´ë¦„ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ì¶œë ¥ í¬ê¸°ë¥¼ ë³´ë©´ ìƒ˜í”Œê°œìˆ˜ê°€ ì •ì˜ë˜ì–´ ìˆì§€ ì•Šì•„ Noneìœ¼ë¡œ ë‚˜ì˜¨ë‹¤. ì™œ ê·¸ëŸ´ê¹Œ? ë°”ë¡œ ì‚¬ìš©ìê°€ batch_size ë§¤ê°œë³€ìˆ˜ë¡œ ë¯¸ë‹ˆ ë°°ì¹˜ ê°œìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ìƒ˜í”Œ ê°œìˆ˜ë¥¼ ê³ ì •í•˜ì§€ ì•Šê³  ì–´ë–¤ ë°°ì¹˜ í¬ê¸°ì—ë„ ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ Noneìœ¼ë¡œ ì„¤ì •í•œë‹¤. ì´ë ‡ê²Œ ì‹ ê²½ë§ ì¸µì— ì…ë ¥ë˜ê±°ë‚˜ ì¶œë ¥ë˜ëŠ” ë°°ì—´ì˜ ì²« ë²ˆì§¸ ì°¨ì›ì„ ë°°ì¹˜ ì°¨ì› ì´ë¼ê³  ë¶€ë¥¸ë‹¤.<br />
ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ë¥¼ ë³´ë©´ ì²˜ìŒì— 78,500ê°œê°€ ì¡´ì¬í•œë‹¤. ì…ë ¥ì¸µ 784ê°œì˜ ë‰´ëŸ°ì— ì€ë‹‰ì¸µì˜ 100ê°œ ë‰´ëŸ°ì„ ê³±í•˜ë©´ 78,400ê°œê°€ ëœë‹¤. ì—¬ê¸°ì— ì€ë‹‰ì¸µ 100ê°œ ë‰´ëŸ°ì˜ ì ˆí¸ ê°œìˆ˜ê¹Œì§€ ë”í•˜ë©´ 78,500ê°œê°€ ëœë‹¤. ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” 100 x 10 + 10 ìœ¼ë¡œ 1,010ê°œê°€ ëœë‹¤! ì´ ëª¨ë¸ íŒŒë¼ë¯¸í„° ê°œìˆ˜ì™€ í›ˆë ¨ë˜ëŠ” íŒŒë¼ë¯¸í„° ê°œìˆ˜ê°€ ë™ì¼í•˜ê²Œ 79,510ê°œë¡œ ë‚˜ì˜¨ë‹¤. Non-trainable paramsëŠ” 0ìœ¼ë¡œ ë‚˜ì˜¤ëŠ”ë°, ê°„í˜¹ ê²½ì‚¬ í•˜ê°•ë²•ìœ¼ë¡œ í›ˆë ¨ë˜ì§€ ì•ŠëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì§„ ì¸µì´ ìˆë‹¤. ì´ëŸ° ì¸µì´ ì—¬ê¸°ì— ë‚˜íƒ€ë‚˜ê²Œ ëœë‹¤.</p>

<h2 id="1-3-ì¸µì„-ì¶”ê°€í•˜ëŠ”-ë‹¤ë¥¸-ë°©ë²•">1-3. ì¸µì„ ì¶”ê°€í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•</h2>
<p>ì²«ë²ˆì§¸ ë°©ë²•.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">784</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s">'hidden'</span><span class="p">),</span>
    <span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'output'</span><span class="p">)</span>
<span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s">'íŒ¨ì…˜ MNIST ëª¨ë¸'</span><span class="p">)</span>

<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Model: "íŒ¨ì…˜ MNIST ëª¨ë¸"
       _________________________________________________________________
       Layer (type)                 Output Shape              Param #   
       =================================================================
       hidden (Dense)               (None, 100)               78500     
       _________________________________________________________________
       output (Dense)               (None, 10)                1010      
       =================================================================
       Total params: 79,510
       Trainable params: 79,510
       Non-trainable params: 0
       _________________________________________________________________
</code></pre></div></div>

<p>ë‘ë²ˆì§¸ ë°©ë²•.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">784</span><span class="p">,)))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Model: "sequential_1"
       _________________________________________________________________
       Layer (type)                 Output Shape              Param #   
       =================================================================
       dense_4 (Dense)              (None, 100)               78500     
       _________________________________________________________________
       dense_5 (Dense)              (None, 10)                1010      
       =================================================================
       Total params: 79,510
       Trainable params: 79,510
       Non-trainable params: 0
       _________________________________________________________________
</code></pre></div></div>

<p>ì´ì œ ëª¨ë¸ì„ í›ˆë ¨í•´ë³´ì. <code class="language-plaintext highlighter-rouge">compile()</code> ë©”ì†Œë“œ ì„¤ì •ì€ 1ì¥ê³¼ ë™ì¼í•˜ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s">'sparse_categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s">'accuracy'</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)
</code></pre></div></div>

<p>ëª‡ ê°œì˜ ì¸µì„ ì¶”ê°€í•´ë„ <code class="language-plaintext highlighter-rouge">compile()</code> ë©”ì†Œë“œì™€ <code class="language-plaintext highlighter-rouge">fit()</code> ë©”ì†Œë“œ ì‚¬ìš©ë²•ì€ ë™ì¼í•˜ë‹¤.</p>

<h2 id="1-4-ë ë£¨-í•¨ìˆ˜">1-4. ë ë£¨ í•¨ìˆ˜</h2>
<p class="align-center">ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ì˜ ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.<br />
$\phi = \frac{1}{1+e^{-x}}$<br />
ì´ë¥¼ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
<img src="/assets/images/deeplearningtens/2-1.png" alt="ê·¸ë¦¼ 2-1. ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜" /></p>
<p>ê·¸ë¦¼ 2-1. ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜</p>

<p class="align-center">ë³´ë‹¤ì‹œí”¼ ì˜¤ë¥¸ìª½ê³¼ ì™¼ìª½ ëìœ¼ë¡œ ê°ˆìˆ˜ë¡ ê·¸ë˜í”„ê°€ ëˆ„ì›Œìˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ì˜¬ë°”ë¥¸ ì¶œë ¥ì„ ë§Œë“œëŠ”ë° ì‹ ì†í•œ ëŒ€ì‘ì´ ì–´ë µë‹¤. íŠ¹íˆ ì¸µì´ ë§ì€ ì‹¬ì¸µ ì‹ ê²½ë§ì—ì„œëŠ” ê·¸ íš¨ê³¼ê°€ ëˆ„ì ë˜ì–´ í•™ìŠµì„ ë” ì–´ë µê²Œ ë§Œë“ ë‹¤.<br />
<strong>ë ë£¨(ReLU)</strong> í•¨ìˆ˜ëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤. ì…ë ¥ì´ ì–‘ìˆ˜ì¼ ê²½ìš° ë§ˆì¹˜ í™œì„±í™” í•¨ìˆ˜ê°€ ì—†ëŠ” ê²ƒì²˜ëŸ¼ ê·¸ëƒ¥ ì…ë ¥ì„ í†µê³¼ì‹œí‚¤ê³  ìŒìˆ˜ì¼ ê²½ìš° 0ìœ¼ë¡œ ë§Œë“ ë‹¤.
<img src="/assets/images/deeplearningtens/2-2.png" alt="ê·¸ë¦¼ 2-2. ë ë£¨ í•¨ìˆ˜" /></p>
<p>ê·¸ë¦¼ 2-2. ë ë£¨ í•¨ìˆ˜</p>

<p>ë ë£¨ í•¨ìˆ˜ëŠ” max(0,z)ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. zê°€ 0ë³´ë‹¤ í¬ë©´ zë¥¼ ì¶œë ¥í•˜ê³  0ë³´ë‹¤ ì‘ìœ¼ë©´ 0ì„ ì¶œë ¥í•œë‹¤. ë ë£¨ í•¨ìˆ˜ëŠ” ì´ë¯¸ì§€ ì²˜ë¦¬ì—ì„œ íŠ¹íˆ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¸ë‹¤ê³  ì•Œë ¤ì ¸ ìˆë‹¤.<br /></p>

<p>ì§€ê¸ˆê¹Œì§€ 1ì°¨ì› í˜•íƒœë¡œ ì´ë¯¸ì§€ë¥¼ ë³€í˜•í•  ë•Œ ìš°ë¦¬ëŠ” <code class="language-plaintext highlighter-rouge">reshape()</code> ë©”ì†Œë“œë¥¼ í™œìš©í–ˆë‹¤. ì¼€ë¼ìŠ¤ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">Flatten</code> ì¸µì„ ì œê³µí•´ì¤€ë‹¤. <code class="language-plaintext highlighter-rouge">Flatten</code> í´ë˜ìŠ¤ëŠ” ë°°ì¹˜ ì°¨ì›ì„ ì œì™¸í•˜ê³  ë‚˜ë¨¸ì§€ ì…ë ¥ ì°¨ì›ì„ ëª¨ë‘ ì¼ë ¬ë¡œ í¼ì¹˜ëŠ” ì—­í• ë§Œ í•œë‹¤. ì…ë ¥ì— ê³±í•´ì§€ëŠ” ê°€ì¤‘ì¹˜ë‚˜ ì ˆí¸ì€ ì „í˜€ ì—†ë‹¤. ì…ë ¥ì¸µ ë°”ë¡œ ë’¤ì— Flatten ì¸µì„ ì¶”ê°€í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Model: "sequential_2"
       _________________________________________________________________
       Layer (type)                 Output Shape              Param #   
       =================================================================
       flatten (Flatten)            (None, 784)               0         
       _________________________________________________________________
       dense_6 (Dense)              (None, 100)               78500     
       _________________________________________________________________
       dense_7 (Dense)              (None, 10)                1010      
       =================================================================
       Total params: 79,510
       Trainable params: 79,510
       Non-trainable params: 0
       _________________________________________________________________
</code></pre></div></div>

<p>Flatten ì¸µì´ í•™ìŠµí•˜ëŠ” ì¸µì´ ì•„ë‹ˆë¯€ë¡œ ëª¨ë¸ íŒŒë¼ë¯¸í„°ëŠ” 0ê°œì´ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">),</span> <span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">teset_target</span><span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">train_input</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="n">train_scaled</span><span class="p">,</span> <span class="n">val_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s">'sparse_categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s">'accuracy'</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) Epoch 1/5
       1500/1500 [==============================] - 3s 2ms/step - loss: 0.5275 - accuracy: 0.8127
       Epoch 2/5
       1500/1500 [==============================] - 3s 2ms/step - loss: 0.3914 - accuracy: 0.8594: 0s - loss:
       Epoch 3/5
       1500/1500 [==============================] - 3s 2ms/step - loss: 0.3521 - accuracy: 0.8724
       Epoch 4/5
       1500/1500 [==============================] - 3s 2ms/step - loss: 0.3327 - accuracy: 0.8812: 0s - loss: 0.3317 - accuracy: 
       Epoch 5/5
       1500/1500 [==============================] - 3s 2ms/step - loss: 0.3160 - accuracy: 0.8865
       &lt;tensorflow.python.keras.callbacks.History at 0x18340930898&gt;
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_scaled</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) 375/375 [==============================] - 1s 2ms/step - loss: 0.3614 - accuracy: 0.8764 [0.3613932430744171, 0.8764166831970215]
</code></pre></div></div>
:ET