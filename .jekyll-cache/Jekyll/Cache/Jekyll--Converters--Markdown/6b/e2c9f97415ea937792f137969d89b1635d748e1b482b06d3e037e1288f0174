I"Ç&<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œë”¥ëŸ¬ë‹ í…ì„œí”Œë¡œ êµê³¼ì„œâ€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="2-1-ì§€ë„í•™ìŠµ">2-1. ì§€ë„í•™ìŠµ</h2>
<p>ì§€ë„ í•™ìŠµì€ ì •ë‹µ(=ë ˆì´ë¸”)ì„ ì»´í“¨í„°ì— ë¯¸ë¦¬ ì•Œë ¤ì£¼ê³  ë°ì´í„°ë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ë°©ë²•ì´ë‹¤. ì§€ë„ í•™ìŠµì—ëŠ” í¬ê²Œ ë¶„ë¥˜ì™€ íšŒê·€ê°€ ìˆë‹¤. ë¶„ë¥˜ëŠ” ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ ì •í•´ì§„ ë²”ì£¼ì— ë”°ë¼ ë¶„ë¥˜í•˜ê³ , íšŒê·€ëŠ” ë°ì´í„°ë“¤ì˜ íŠ¹ì„±ì„ ê¸°ì¤€ìœ¼ë¡œ ì—°ì†ëœ ê°’ì„ ê·¸ë˜í”„ë¡œ í‘œí˜„í•˜ì—¬ íŒ¨í„´ì´ë‚˜ íŠ¸ë Œë“œë¥¼ ì˜ˆì¸¡í•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>

<ul>
  <li>ë¶„ë¥˜<br />
    <ul>
      <li>ë°ì´í„° ìœ í˜•: ì´ì‚°í˜• ë°ì´í„°<br /></li>
      <li>ê²°ê³¼: í›ˆë ¨ ë°ì´í„°ì˜ ë ˆì´ë¸” ì¤‘ í•˜ë‚˜ë¥¼ ì˜ˆì¸¡<br /></li>
    </ul>
  </li>
  <li>íšŒê·€<br />
    <ul>
      <li>ë°ì´í„° ìœ í˜•: ì—°ì†í˜• ë°ì´í„°<br /></li>
      <li>ê²°ê³¼: ì—°ì†ëœ ê°’ì„ ì˜ˆì¸¡<br /></li>
    </ul>
  </li>
</ul>

<h2 id="2-2-k-ìµœê·¼ì ‘-ì´ì›ƒ">2-2. K-ìµœê·¼ì ‘ ì´ì›ƒ</h2>
<ul>
  <li>ì™œ ì‚¬ìš©? â†’ ì£¼ì–´ì§„ ë°ì´í„°ì— ëŒ€í•œ ë¶„ë¥˜<br /></li>
  <li>ì–¸ì œ ì‚¬ìš©? â†’ ì§ê´€ì ì´ê³  ì‚¬ìš©í•˜ê¸° ì‰¬ì›Œ ì´ˆë³´ìê°€ ì“°ê¸° ì¢‹ê³ , í›ˆë ¨ ë°ì´í„°ë¥¼ ì¶©ë¶„íˆ í™•ë³´í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ë©´ ì¢‹ìŒ<br /></li>
</ul>

<p>K-ìµœê·¼ì ‘ ì´ì›ƒì€ ìƒˆë¡œìš´ ì…ë ¥ì„ ë°›ì•˜ì„ ë•Œ ê¸°ì¡´ í´ëŸ¬ìŠ¤í„°ì—ì„œ ëª¨ë“  ë°ì´í„°ì™€ ì¸ìŠ¤í„´ìŠ¤(ìƒˆë¡œìš´ ë°ì´í„° ë“¤ì–´ì˜¬ ë•Œ ë°ì´í„°ì™€ ë°ì´í„° ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í•œ ê´€ì¸¡ì¹˜ ì˜ë¯¸) ê¸°ë°˜ ê±°ë¦¬ë¥¼ ì¸¡ì • í›„, ê°€ì¥ ë§ì€ ì†ì„±ì„ ê°€ì§„ í´ëŸ¬ìŠ¤í„°ì— í• ë‹¹í•˜ëŠ” ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. Kê°’ì„ ì–´ë–»ê²Œ ì„¤ì •í•˜ëŠëƒì— ë”°ë¼ ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•œ ë¶„ë¥˜ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤. iris ë°ì´í„°ë¥¼ í™œìš©í•œ ì½”ë“œ ì˜ˆì œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸ì¶œ ë° ë°ì´í„° ì¤€ë¹„
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sepal-length'</span><span class="p">,</span> <span class="s">'sepal-width'</span><span class="p">,</span> <span class="s">'petal-length'</span><span class="p">,</span> <span class="s">'petal-width'</span><span class="p">,</span> <span class="s">'Class'</span><span class="p">]</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'iris.data'</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>

<span class="c1"># í›ˆë ¨ê³¼ ê²€ì¦ ë°ì´í„°ì…‹ ë¶„ë¦¬
</span><span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">].</span><span class="n">values</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">s</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># ëª¨ë¸ ìƒì„± ë° í›ˆë ¨
</span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">knn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># ëª¨ë¸ ì •í™•ë„
</span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"ì •í™•ë„: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>

<span class="c1"># ìµœì ì˜ K ì°¾ê¸°
</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span>
<span class="n">acc_array</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">acc_array</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">acc</span>

<span class="n">max_acc</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">amax</span><span class="p">(</span><span class="n">acc_array</span><span class="p">)</span>
<span class="n">acc_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">acc_array</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">acc_list</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">max_acc</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"ì •í™•ë„"</span><span class="p">,</span> <span class="n">max_acc</span><span class="p">,</span> <span class="s">"ìœ¼ë¡œ ìµœì ì˜ këŠ”"</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s">"ì…ë‹ˆë‹¤."</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) ì •í™•ë„: 0.8
       ì •í™•ë„ 1.0 ìœ¼ë¡œ ìµœì ì˜ këŠ” 1 ì…ë‹ˆë‹¤.
</code></pre></div></div>

<p>K ê°’ì´ 50ì¼ ë•Œ ì •í™•ë„ëŠ” 80%ì˜€ëŠ”ë°, K ê°’ì´ 1ì¼ ë•Œ ì •í™•ë„ëŠ” 100%ë¡œ ë†’ì•„ì¡Œë‹¤. ì´ì²˜ëŸ¼ K-ìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜ì€ K ê°’ì— ë”°ë¼ ì„±ëŠ¥ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ˆê¸° ì„¤ì •ì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.</p>

<h2 id="2-3-ì„œí¬íŠ¸-ë²¡í„°-ë¨¸ì‹ ">2-3. ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ </h2>

:ET