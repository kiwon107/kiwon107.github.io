I"É&<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="1-1-íŒ¨ì…˜-mnist">1-1. íŒ¨ì…˜ MNIST</h2>
<p>ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ ë¶“ê½ƒ ë°ì´í„°ì…‹ì´ ìœ ëª…í•˜ë‹¤ë©´, ë”¥ëŸ¬ë‹ì—ì„œëŠ” MNIST ë°ì´í„°ì…‹ì´ ìœ ëª…í•˜ë‹¤. ì´ ë°ì´í„°ëŠ” ì†ìœ¼ë¡œ ì“´ 0~9ê¹Œì§€ì˜ ìˆ«ìë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. í…ì„œí”Œë¡œë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤. í…ì„œí”Œë¡œì˜ ì¼€ë¼ìŠ¤ íŒ¨í‚¤ì§€ë¥¼ ì„í¬íŠ¸í•˜ê³  íŒ¨ì…˜ MNIST ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">),</span> <span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_input</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">train_target</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">test_input</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test_target</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) (60000, 28, 28) (60000,)
       (10000, 28, 28) (10000,)
</code></pre></div></div>

<p>ì–´ë–¤ ì´ë¯¸ì§€ì¸ì§€ ì‹œê°í™”í•˜ì—¬ í™•ì¸í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_input</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'gray_r'</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/deeplearningtens/1-1.JPG" alt="ê·¸ë¦¼ 1-1. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 1-1. ì½”ë“œ ê²°ê³¼</p>

<p>ê° ê·¸ë¦¼ì˜ íƒ€ê²Ÿì´ ë¬´ì—‡ì¸ì§€ë„ í™•ì¸í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">([</span><span class="n">train_target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) [9, 0, 0, 3, 0, 2, 7, 2, 5, 5]
</code></pre></div></div>

<p>íŒ¨ì…˜ MNISTì˜ íƒ€ê¹ƒì€ 0~9ê¹Œì§€ì˜ ìˆ«ì ë ˆì´ë¸”ë¡œ êµ¬ì„±ëœë‹¤. 10ê°œ ë ˆì´ë¸”ì˜ ì˜ë¯¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.<br /></p>
<ul>
  <li>0: í‹°ì…”ì¸ <br /></li>
  <li>1: ë°”ì§€<br /></li>
  <li>2: ìŠ¤ì›¨í„°<br /></li>
  <li>3: ë“œë ˆìŠ¤<br /></li>
  <li>4: ì½”íŠ¸<br /></li>
  <li>5: ìƒŒë‹¬<br /></li>
  <li>6: ì…”ì¸ <br /></li>
  <li>7: ìŠ¤ë‹ˆì»¤ì¦ˆ<br /></li>
  <li>8: ê°€ë°©<br /></li>
  <li>9: ì•µí´ ë¶€ì¸ <br /></li>
</ul>

<p>ê° ë ˆì´ë¸” ë‹¹ ìƒ˜í”Œ ê°œìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">train_target</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) (array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=uint8), array([6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], dtype=int64))
</code></pre></div></div>

<h2 id="1-2-ë¡œì§€ìŠ¤í‹±-íšŒê·€ë¡œ-íŒ¨ì…˜-ì•„ì´í…œ-ë¶„ë¥˜í•˜ê¸°">1-2. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ íŒ¨ì…˜ ì•„ì´í…œ ë¶„ë¥˜í•˜ê¸°</h2>
<p>í›ˆë ¨ ìƒ˜í”Œì´ 60,000ê°œë‚˜ ë˜ë¯€ë¡œ, ì „ì²´ ë°ì´í„°ë¥¼ í•œêº¼ë²ˆì— ì‚¬ìš©í•˜ê¸°ë³´ë‹¤, ìƒ˜í”Œì„ í•˜ë‚˜ì”© êº¼ë‚´ì„œ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ëŠ”ê²Œ ë” íš¨ìœ¨ì ì´ë‹¤. <code class="language-plaintext highlighter-rouge">SGDClassifier</code> í´ë˜ìŠ¤ì˜ loss ë§¤ê°œë³€ìˆ˜ë¥¼ â€˜logâ€™ë¡œ ì§€ì •í•˜ì—¬ ë¡œì§€ìŠ¤í‹± ì†ì‹¤ í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²• ëª¨ë¸ì„ ë§Œë“¤ì. íŠ¹ì„±ë§ˆë‹¤ ê°’ì˜ ë²”ìœ„ë¥¼ ë™ì¼í•˜ê²Œ í•˜ì—¬ ì˜¬ë°”ë¥´ê²Œ ì†ì‹¤ í•¨ìˆ˜ì˜ ê²½ì‚¬ë¥¼ ë‚´ë ¤ì˜¬ ìˆ˜ ìˆë„ë¡ 0~1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ì •ê·œí™”ë¥¼ í•˜ì. ê·¸ ë‹¤ìŒ, 2ì°¨ì› í˜•íƒœë¥¼ 1ì°¨ì›ìœ¼ë¡œ ë³€í™˜í•˜ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_scaled</span> <span class="o">=</span> <span class="n">train_input</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">train_scaled</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) (60000, 784)
</code></pre></div></div>

<p>ì´ì œ <code class="language-plaintext highlighter-rouge">SGDClassifier</code> í´ë˜ìŠ¤ì™€ <code class="language-plaintext highlighter-rouge">cross_validate</code> í•¨ìˆ˜ë¡œ ì´ ë°ì´í„°ì—ì„œ êµì°¨ ê²€ì¦ ì„±ëŠ¥ì„ í™•ì¸í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s">'log'</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="s">'test_score'</span><span class="p">]))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) 0.8192833333333333
</code></pre></div></div>

<p>ë­”ê°€ ê²°ê³¼ê°€ ê¸°ëŒ€ì¹˜ì— ëª»ë¯¸ì¹˜ëŠ”ë“¯ í•˜ë‹¤.</p>

<p>ë¡œì§€ìŠ¤í‹± íšŒê·€ ê³µì‹ì— ë”°ë¼ íŒ¨ì…˜ MNIST ë°ì´í„°ì— ë§ê²Œ ë³€í˜•í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.
$z_í‹°ì…”ì¸  = w1 \times (í”½ì…€1) + w2 \times (í”½ì…€2) + â€¦ + w784 \times (í”½ì…€784) + b$<br />
ë‘ë²ˆì§¸ ë ˆì´ë¸”ì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤</p>
:ET