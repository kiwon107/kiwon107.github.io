I"ã6<p>ë³¸ í¬ìŠ¤íŒ…ì€ â€œí˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹â€ ì±… ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ì˜ëª»ëœ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì§€ì í•´ ì£¼ì‹œë©´ ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="9-1-ë¡œì§€ìŠ¤í‹±-íšŒê·€ë¡œ-ì™€ì¸-ë¶„ë¥˜í•˜ê¸°">9-1. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ì™€ì¸ ë¶„ë¥˜í•˜ê¸°</h2>
<p>ì™€ì¸ ë°ì´í„°ë¥¼ í•œë²ˆ ë´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">wine</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://bit.ly/wine_csv_data'</span><span class="p">)</span>
<span class="n">wine</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) alcohol	sugar	 pH	   class
    0	9.4 	1.9	    3.51	0.0
    1	9.8	    2.6	    3.20	0.0
    2	9.8	    2.3	    3.26	0.0
    3	9.8	    1.9	    3.16	0.0
    4	9.4	    1.9	    3.51	0.0 ë„ìˆ˜, ë‹¹ë„, PHë¥¼ ê°€ì§€ê³  ë ˆë“œì™€ì¸ì¸ì í™”ì´íŠ¸ì™€ì¸ì¸ì§€ ì•Œì•„ì•¼í•˜ëŠ” ë¬¸ì œì´ë‹¤.
</code></pre></div></div>

<p>info() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°í”„ë ˆì„ì˜ ê° ì—´ ë°ì´í„° íƒ€ì…ê³¼ ëˆ„ë½ëœ ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ”ë° ìœ ìš©í•˜ë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wine</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) &lt;class 'pandas.core.frame.DataFrame'&gt;
       RangeIndex: 6497 entries, 0 to 6496
       Data columns (total 4 columns):
       alcohol    6497 non-null float64
       sugar      6497 non-null float64
       pH         6497 non-null float64
       class      6497 non-null float64
       dtypes: float64(4)
       memory usage: 203.2 KB
</code></pre></div></div>

<p>ì™€ì¸ ë°ì´í„°ë¥¼ ë³´ë©´ Non-Null Countê°€ 6497ì´ê³ , ì´ ìƒ˜í”Œ ê°œìˆ˜ë„ 6497ê°œë¼ê³  ë‚˜ì˜¨ë‹¤. ì´ì—ë”°ë¼, ëˆ„ë½ëœ ê°’ì€ ì—†ëŠ”ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. ë§Œì•½ ëˆ„ë½ëœ ê°’ì´ ìˆìœ¼ë©´, ê·¸ ë°ì´í„°ë¥¼ ë²„ë¦¬ê±°ë‚˜ í‰ê· ê°’ìœ¼ë¡œ ì±„ìš´ í›„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì–´ë–¤ ë°©ì‹ì´ ìµœì„ ì¸ì§€ëŠ” ì•Œê¸° ì–´ë ¤ìš°ë‹ˆ ë‘ ê°€ì§€ ëª¨ë‘ ì‹œë„í•´ ë³´ëŠ”ê²Œ ì¢‹ë‹¤! ë§Œì•½ í‰ê· ê°’ìœ¼ë¡œ ì±„ì›Œ ë„£ëŠ”ë‹¤ê³  í•˜ë©´, í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ëˆ„ë½ëœ ê°’ì€ í›ˆë ¨ ì„¸íŠ¸ì˜ í‰ê· ê°’ìœ¼ë¡œ ì±„ì›Œì•¼ í•œë‹¤!</p>

<p>describe() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì—´ë° ëŒ€í•œ ê°„ëµí•œ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wine</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼)      alcohol	    sugar	        pH	      class
    count	6497.000000	6497.000000	6497.000000	6497.000000
    mean	10.491801	5.443235	3.218501	0.753886
    std	    1.192712	4.757804	0.160787	0.430779
    min	    8.000000	0.600000	2.720000	0.000000
    25%	    9.500000	1.800000	3.110000	1.000000
    50%	    10.300000	3.000000	3.210000	1.000000
    75%	    11.300000	8.100000	3.320000	1.000000
    max	    14.900000	65.800000	4.010000	1.000000
</code></pre></div></div>

<p>í‰ê· , í‘œì¤€í¸ì°¨, ìµœì†Œ, ìµœëŒ€ê°’ì„ ë³¼ ìˆ˜ ìˆë‹¤. ì¤‘ê°„ê°’(50%), 1ì‚¬ë¶„ìœ„ìˆ˜(25%), 3ì‚¬ë¶„ìœ„ìˆ˜(75%)ë„ ì•Œë ¤ì¤€ë‹¤.
ì‚¬ë¶„ìœ„ìˆ˜ëŠ” ë°ì´í„°ë¥¼ ì¼ë ¬ë¡œ ëŠ˜ì–´ë†“ê³ , ë°ì´í„°ë¥¼ ìˆœì„œëŒ€ë¡œ 4ë“±ë¶„ í•œ ê°’ì´ë‹¤. ë§Œì•½ ë°ì´í„° ê°œìˆ˜ê°€ ì§ìˆ˜ê°œ ì´ë©´ ì¤‘ì•™ê°’ì€ ê°€ìš´ëŒ€ 2ê°œì˜ ê°’ì˜ í‰ê· ì„ ì‚¬ìš©í•œë‹¤ê³  í•œë‹¤.
ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ì™€ì¸ì„ ë¶„ë¥˜í•´ë³´ì!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">wine</span><span class="p">[[</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="s">'sugar'</span><span class="p">,</span> <span class="s">'pH'</span><span class="p">]].</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">wine</span><span class="p">[</span><span class="s">'class'</span><span class="p">].</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_input</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test_input</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ss</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_input</span><span class="p">)</span>
<span class="n">test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) (5197, 3) (1300, 3)
       0.7808350971714451
       0.7776923076923077
</code></pre></div></div>

<p>í›ˆë ¨ ì„¸íŠ¸, í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ëª¨ë‘ ì ìˆ˜ê°€ ë‚®ì€ê±¸ ë³´ë©´ ê³¼ì†Œ ì í•©ì¸ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p>

<h2 id="9-2-ì„¤ëª…í•˜ê¸°-ì‰¬ìš´-ëª¨ë¸ê³¼-ì–´ë ¤ìš´-ëª¨ë¸">9-2. ì„¤ëª…í•˜ê¸° ì‰¬ìš´ ëª¨ë¸ê³¼ ì–´ë ¤ìš´ ëª¨ë¸</h2>
<p>ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ í•™ìŠµí•œ ê³„ìˆ˜ì™€ ì ˆí¸ì„ ì¶œë ¥í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">lr</span><span class="p">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">lr</span><span class="p">.</span><span class="n">intercept_</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) [[ 0.51270274  1.6733911  -0.68767781]] [1.81777902]
</code></pre></div></div>

<p>ì € ê°€ì¤‘ì¹˜ì™€ í¸í–¥ì´ ì–´ë–¤ ê²ƒì´ë¼ëŠ”ê±´ ì•Œê³ ìˆì§€ë§Œ, ì™œ ì € ê°’ì´ ë‚˜ì™”ëŠ”ì§€ ì´í•´í•˜ê¸°ëŠ” ì–´ë µë‹¤. ë­”ê°€ ì™œ ì´ëŸ° ê²°ê³¼ê°€ ë‚˜ì™”ëŠ”ì§€ ì‰½ê²Œ ì„¤ëª… ê°€ëŠ¥í•œ ëª¨ë¸ì€ ì—†ì„ê¹Œ?</p>

<h2 id="9-3-ê²°ì •-íŠ¸ë¦¬">9-3. ê²°ì • íŠ¸ë¦¬</h2>
<p><strong>ê²°ì • íŠ¸ë¦¬(Decision Tree)</strong>ëŠ” ìŠ¤ë¬´ê³ ê°œì™€ ê°™ë‹¤. ì§ˆë¬¸ì„ í•˜ë‚˜ì”© ë˜ì ¸ ì •ë‹µê³¼ ë§ì¶°ê°€ëŠ” ê²ƒì´ ë°”ë¡œ ê²°ì • íŠ¸ë¦¬ì˜ ì›ë¦¬ì´ë‹¤. ë°ì´í„°ë¥¼ ì˜ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ì§ˆë¬¸ì„ ì°¾ìœ¼ë©´ ê³„ì† ì§ˆë¬¸ì„ ì¶”ê°€í•´ì„œ ë¶„ë¥˜ ì •í™•ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆë‹¤. ì‚¬ì´í‚·ëŸ°ì˜ <code class="language-plaintext highlighter-rouge">DecisionTreeClassifier</code> í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì • íŠ¸ë¦¬ ëª¨ë¸ì„ í›ˆë ¨í•  ìˆ˜ ìˆë‹¤. ê²°ì • íŠ¸ë¦¬ ì•Œê³ ë¦¬ì¦˜ì€ ë…¸ë“œì—ì„œ ìµœì ì˜ ë¶„í• ì„ ì°¾ê¸° ì „ì— íŠ¹ì„±ì˜ ìˆœì„œë¥¼ ì„ëŠ”ë‹¤. ì•½ê°„ì˜ ë¬´ì‘ìœ„ì„±ì´ ë“¤ì–´ê°€ê¸° ë•Œë¬¸ì— ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ì ìˆ˜ê°€ ì¡°ê¸ˆì”© ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">dt</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dt</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">train_target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">dt</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_scaled</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(ê²°ê³¼) 0.996921300750433
       0.8592307692307692
</code></pre></div></div>

<p>ì•½ê°„ ê³¼ëŒ€ë•í•©ëœ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. ê³¼ì—° ì´ ëª¨ë¸ì€ ì–´ë–»ê²Œ ì‰½ê²Œ ì„¤ëª…í•  ìˆ˜ ìˆì„ê¹Œ? <code class="language-plaintext highlighter-rouge">plot_tree()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">plot_tree</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plot_tree</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/machinelearning/9-1.png" alt="ê·¸ë¦¼ 9-1. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 9-1. ì½”ë“œ ê²°ê³¼</p>

<p>ë³´ë‹¤ì‹œí”¼ ì—„ì²­ë‚œ íŠ¸ë¦¬ê°€ ë§Œë“¤ì–´ì¡Œë‹¤. ë§¨ ìœ„ì˜ ë…¸ë“œë¥¼ ë£¨íŠ¸ ë…¸ë“œë¼ê³  í•œë‹¤. ë…¸ë“œëŠ” ê²°ì • íŠ¸ë¦¬ë¥¼ êµ¬ì„±í•˜ëŠ” í•µì‹¬ ìš”ì†Œì´ë‹¤. ë…¸ë“œëŠ” í›ˆë ¨ ë°ì´í„°ì˜ íŠ¹ì„±ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ í‘œí˜„í•œë‹¤. ê°€ì§€ëŠ” í…ŒìŠ¤íŠ¸ì˜ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ê³  ì¼ë°˜ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ë…¸ë“œëŠ” 2ê°œì˜ ê°€ì§€ë¥¼ ê°€ì§„ë‹¤. í•œë²ˆ íŠ¸ë¦¬ì˜ ê¸¸ì´ë¥¼ ì œí•œí•´ì„œ ë‹¤ì‹œ ì¶œë ¥í•´ë³´ì.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plot_tree</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s">'alcohol'</span><span class="p">,</span> <span class="s">'sugar'</span><span class="p">,</span> <span class="s">'pH'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p class="align-center"><img src="/assets/images/machinelearning/9-2.png" alt="ê·¸ë¦¼ 9-2. ì½”ë“œ ê²°ê³¼" /></p>
<p>ê·¸ë¦¼ 9-2. ì½”ë“œ ê²°ê³¼</p>
:ET